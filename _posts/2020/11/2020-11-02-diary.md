---
title: 190 日目（曇りのち雨）風邪ッぴきの兆候あり
---

0:10 明日やることを脳裡で確認しながら就寝。ハローワークには行きたいし、銀行の残高も見たいし、
現金書留が来るのかどうかはわからないし、何か忘れるだろう。

9:05 携帯電話のブルブルで起床。ヤフーメールのマイレージとやらを貯めると通信容量が月 0.5GB 増えるとか。
それは早く言って欲しかった。

洗濯をしながら朝食。やはり納豆には白飯がいちばん合う。
洗濯物を干す。フリースの上着も洗濯したらフックハンガーが足りなかった。

すぐに外出。9:55 スカイツリー到着。店舗は開いていないのでトイレだけ使わせてもらって退場。
徒歩でハローワーク墨田に移動。数日分の求人をフルタイムとパートタイムを問わずに調べる。掃除しか目に止まらない。

11:15 ハローワークを出てアルカキット錦糸町に移動。くまざわ書店で雑誌チェック。明日が祝日なのでスパとかも並んでいる。

駅前のバスターミナルから日暮里駅行きに乗る。始点から終点まで乗るとは。
日暮里で時間調整をしてから亀戸駅行きに乗って荒川三丁目まで移動。
バスの移動中に読んでいたどこかの Wizardry 4 プレイ日記を読み終えてしまう。

13:05 ビッグエー荒川三丁目店。195 円。

* 麦茶 (500)
* メンチカツドッグ
* 大きなりんごデニッシュ

荒川公園でおやつ休憩。それからゆいの森あらかわへ移動。13:30 四階で着席。
VS Code の C++ 環境づくりをまだやる。問題点を二つに絞るところまで進める。
パス文字列のバックスラッシュをスラッシュに変換する手段がないことか、環境変数 `PATH` が Cygwin の `bin` を含んでいないことが問題だ。
なぜ VS Code の設定ファイルの変数には文字列置換機能がないのだろう。

15:30 新聞（産経）を読んで退館。雨が降りそうだ。バス停へ行く。わりとすぐに来た。

16:30 曳舟の部屋に戻る。Windows Update を実施して 15 分後に作業に復帰。べらぼうに眠い。
そういえば今日は受給日なのだが、現金書留はまだ来ていないようだ。書留になってから一日は遅れる。急いで戻ることもなかったか。

せっかくだから C++11 の学習を進めておく。コンパイラー寄りの機能から再開。

18:30 頃外出。雨が降っているので靴を面接用のものに代えるべきだったが、いつものドンキ靴で強行。
八広方面に歩く。途中のコンビニでキンマをチェック。むこうぶちは連載終了ではなさそうだ？

19:15 ビッグエー墨田八広店。436 円。

* ベビーチーズ鉄分 (4)
* 小粒納豆 (3)
* 大きなおむすび鮭
* ふっくらおむすび明太子
* ハムマヨパン
* ジャムパン

19:50 コモディイイダ東向島店。241 円。

* 中華丼
* おにぎり焼きたらこ

20:00 曳舟の部屋に戻る。PC を開いて晩飯。ハローワークから鼻水が止まらない気がする。
麻雀の練習がきつい。さすがに途中でやめる。

22:00 入浴開始。風邪気味かもしれないので今日は意識的に長湯にする。こんなときこそ銭湯に行って一発回復したいところだが。

22:50 風呂から出る。テザリングしてインターネットを見て回る。
それから[地獄の伯爵令嬢の逆襲][bshf20]のコード整理。

* デバッグルームの着せ替えイベント全部をコモンに移転してデバッグメニューに作り変える。
* 自作デバッグメニューのフラグショップが作りかけだった。石像 4 体それぞれのフラグセットコマンドを追加。まだあるぞ。
  * フラグコントロールはもう少し丁寧に作ると後でいいことがありそうだ。次にやろう。

ところでコモンイベントの呼び出しと予約の使い分け方がまだわからない。
メニュー操作（選択肢）のときは予約のほうがなんとなくいい気がする。うまく説明できないが。

## C++11 Notes

C++11 の学習をすすめる。[cpprefjp] の見出しに沿って今日は C99 からの輸入仕様まで。次回から待望のライブラリー。

### 属性構文

二重の角括弧で囲まれた属性を C++ コードの構成要素に付与することで、コンパイラーが助かるらしい。
今は `[[noreturn]]` と `[[carries_dependency]]` の二つしかない。

`[[noreturn]]` は関数に対する属性であって、文字通り `return` することがない関数に付与する。
[cppjpref] の例では、実行時に必ず例外が送出する関数に対して適用している。

`[[carries_dependency]]` は難しい。並行プログラミングで用いられる。
関数に付与するものと、引数に付与するものの二種類ある。あとでやろう。

### アライメントを指定する - `alignas`

C/C++ のコードを機械語レベルに落として考えるプログラマーならこの機能の役割はすぐにわかると思う。

〈構造体やクラスの宣言時に使用した場合、その型のインスタンス全てをアライメントする〉とある。
例えば 28 バイトの構造体を定義しても、その型の変数を定義するとアドレスが 32 バイト境界に揃えられるということだろう。

このルールは構造体やクラスのメンバー変数についても適用される。

`alinas(nn) typename identifier;` のような文法で指定する（ここで `alinas` だけがキーワード）。

[cppjpref] のサンプルコードは 4 バイト型の align を 1, 2 などで指定しようと試みていることに注意。
そんなことはできないので結局 4 バイト境界揃えになる。

g++ (GCC) 10.0.2 では `alinas(0)` は認められない。あるいはコンパイルオプションの指定が悪いのかもしれない。

### アライメントを取得する - `alignof`

演算子 `alignof` は型に対して作用する。`sizeof` が型にも変数にも作用するのとは違う。

さっきの演算子も含め alignment 関連の演算子は C++ ではなく C の仕様とするべきだと思う（たぶんそうなっている）。

[cppjpref] のデモコードに対しては 32bit 環境での結果が掲載されている。64 bit 環境で出力すると結果の一部が 4 から 8 になる。

### 更新された定義済みマクロ

読まなくていい。

### 機能テストマクロ

g++ (GCC) 10.0.2 では `__has_cpp_attribute(carries_dependency)` が使えないようだ。

### テンプレート再帰回数の制限緩和

読まなくていい。

### キーワード `typename` および `template` の適用範囲拡大

[cppjpref] のデモコードの関数 `main` の二行とも、従来は何かのテンプレートの中でしか書けないコードだった。
二行目は C++03 時代でもお目にかかったことがない文法だが。

### 入れ子の指定にグローバルスコープ `::` を付加する

[cppjpref] の記事だけでは何のことか理解できないので、あとで仕様を見に行く。

### 前方宣言時要素数指定配列機能

これは試すのが面倒臭い。そしてこれも詳細がわからない（意味はわかる）。

### 名前空間 `std::posix` および `::posix`

これらの名前空間が予約された。我々一般プログラマーはこの名前空間を定義してはならない。

### 演算子 `sizeof` がユーザー定義型の非静的メンバー変数をオペランドにとれる

`sizeof MyClass::my_member` のような書き方が許されるようになった。
クラス `MyClass` のどのオブジェクトも `sizeof my_member` の値は等しいのだから問題ない。

### キーワード `register` は非推奨となった

いにしえの記憶域制御系キーワードだが、ついに非推奨になった。
遠い未来の C++ では `auto` のように転生するかもしれない。

### 参照への参照はエラーではなくなった

テンプレートメタプログラミングでありがちなコンパイルエラーであったが、これが C++11 からコンパイラーは単なる参照として扱うようになる。

### C99互換機能

C++11 というより C の仕様なのでここでは細かく分析しない。

* ノートにはとらないが `long long` の件はふつうに重要なので一読すること。64bit 固定とは意味が異なる。
* `__func__` は Python にも似たものがあるが、`static const char*` 型の変数として関数名をその関数のスコープの内部から参照できる。
* 列挙子の末尾へのカンマ付加を許可。まさか `enum` しか認められていない？
* divmod 演算の丸め結果はだいじなので学習する。
  * `a`, `b` を負かもしれない整数型変数とする。いちおう断るが `b != 0` とする。
    このとき値 `a / b` は整数であって、この除算を小数で考えるときに得られる商をゼロ方向に丸める値と等しいものとする。
  * 恒等式 `(a / b) * b + a % b == a` を憶えること。

[cpprefjp]: https://cpprefjp.github.io/
[bshf20]: https://wodifes.net/game/show/412
