---
title: 175 日目（晴れ時々曇り）渋谷区の馴染みのない地域を散策する
---

ウディターをもう少し粘る。フラグを可変 DB に移行しないで済みそうだ。
次のコードで例えば通常変数 `V29` に値 99 をセットすることになる：

<!-- ブルーもしくはブルー撃破 -->
```text
■変数操作: CSelf20 = 0 + 2000029
■変数操作: V[CSelf20] = 0 + 99
```

* 一行目。変数操作ダイアログで、左辺値も右辺値もアドレスとして解釈させないのが要点だ。
* 二行目はダイアログの左辺を `CSelf20` と指定し、「X 番変数」をチェックすることで、アドレスとして解釈させる。

0:35 気が済んだところで就寝。

8:10 起床。一転して空が晴れている。洗濯。トートバッグもキツネの絵が薄汚れてきたので洗濯する。
待ち時間で朝食。おにぎりは鮭のほうを先に食す。お茶漬け味は昼。
携帯電話でニュースを見て洗濯物を干す。キツネがきれいになっていない。

洗濯物の一部が乾くまで PC をやる。上述したウディターの変数まわりのコードを書く。
例のクラスにメンバー変数 `flag_pointer` を追加して例えば `V29` をアクセスしたいならば `2000029` とする。

単体テスト成功。オリジナルのコモンイベント 3 個の中身を自作サブルーチン呼び出し 1 行に置き換えて水晶玉終了。

統合テスト成功。欲を言えばマップイベントのほうも共通化したいが今はいい。
ウディターのコモンイベント編集機能には undo/redo がないので（なぜ？）編集に要らぬ気を使う。
次回はこの手法で石像と石碑のコードを再度作り直す。

10:00 キー入力にまつわる無駄な引数・戻り値を削って仕上げる。いい感じに時間調整になったので外出する。

ひきふね図書館。朝刊（産経、朝日）を読む。月刊雑誌の本 2020.11 号を読む。
西村賢太先生ばりに日記をコンパクトに書ければと思う。

退館。リサイクル本の『完全合格 ORACLE MASTER Bronze 11g SQL 基礎 I 必修教本』を入手。

手拭いを忘れた。いったん部屋に取りに行く。そのまま押上駅に移動。
浅草線に乗って大門で大江戸線に乗り換え、なんとなく青山一丁目駅で降りる。
図書館めぐりなら赤坂図書館に行くのが自然だが、港区の図書館は前回行ったばかりなのでパス。

渋谷方面に大通りを歩く。明治通りで北上。つまり渋谷区中央図書館に向かう。
いつの間にか全席自由席になっている。大歓迎。持ち込み PC での作業がはかどりそうだ。
東京新聞と週刊新潮を読む。計算機書籍のコーナーをチェック。退館。

腹が減ったので公園を探す。千駄ヶ谷に迷い込む。渋谷区の案内図はカラーリングが黒ベースで夜はどうなるか。
鳩森児童遊園というところでおやつ休憩。ちびっこ連れの家族ばかりで居場所がない。

さっきの道へ引き返し、日本将棋連盟本部に突入する。あいにく日曜道場が休みだそうだ。
一階の物販をチェック。将棋好きが何人かいるので邪魔しない。

* 将棋本がずらりと並んでいるが完全に私の守備範囲外。
* 将棋盤の値段がブッ高い。百万オーバー。
* 豊島将之二冠の首振り人形は意味がわからない。

またぞろぶらり歩いて JR 千駄ヶ谷駅へ。すぐ対面に都営大江戸線国立競技場駅だ。乗る。
森下駅で都営新宿線に乗り換えて住吉駅へ。途中気づかずに快速に乗って大島駅まで行ってしまったのは驚く。

あと地下鉄移動時に Wi-Fi で閲覧していたとり夫先生の Pixiv のモンスター図鑑をとうとう全ページ読んでしまった。
イメージはアーカイブをダウンロードできるようにしてあるが、テキストも読ませるので、やはりスクレイピングを考えたい。
しかし、あの JavaScript ベースのサイトの構造をかいくぐるのは私には至難だ。

まっすぐ錦糸町へ歩く。ブックオフロッテシティー錦糸町店に道草してなにかないかチェック。雀荘のサエコさん第 2 巻くらいしかない。

タイトー F ステーションオリナス錦糸町店で 6 クレ遊ぶ。
MJ プロ卓東風戦 5 クレのビートマニア STANDARD モード 1 クレ。特に成果なし。

```text
【SCORE】
合計SCORE:+78.6

【最終段位】
四人打ち段位:雷神 幻球:5

【10/18の最新8試合の履歴】
1st|-*-*-*--
2nd|----*--*
3rd|--*-----
4th|*-----*-
old         new

【順位】
1位回数:4(33.33%)
2位回数:3(25.00%)
3位回数:2(16.67%)
4位回数:3(25.00%)
平均順位:2.33

プレイ局数:55局

【打ち筋】
アガリ率:20.00%(11/55)
平均アガリ翻:4.27翻
平均アガリ巡目:12.18巡
振込み率:7.27%(4/55)

【10/18の最高役】
・跳満
・跳満
・跳満
```

役牌ポンに頼らないというコツを発見した。
あと土田浩翔プロの実況名セリフ「そろそろチートイの出番かな？」にまたぞろ新事実発覚。
リーチ後にも発動する。やはり意図的にやっているな。

19:30 カスミオリナス錦糸町店。511 円。レジ前が妙に混雑している。日曜なのに？

* 野菜ジュース (900)
* 季節の天重三陸産サンマ

20:00 ビッグエー墨田業平店。352 円。

* バナナ (3)
* 大きなおむすび (2)
* ジャムパン
* すっぱムーチョ (+10%)

20:05 曳舟の部屋に戻る。PC で 帳簿などをつける。晩飯とバナナを頬張る。
バナナ 3 本で 44 円はべらぼうに安い。少し傷んでいるくらい気にならない。
テザリングで Twitter などを見る。見るだけなら携帯電話で十分だが、やはり何か書き込みたいときは PC だ。

21:15 テザリング終了。音楽を聴きながら麻雀の練習をする。

22:00 入浴。22:30 風呂から上がる。ウディタいじりをやる。

22:50 石像イベントをユーザーデータベースアクセスに書き換える。
余裕があったら、石像ボスを倒したあとに石像の絵を壊れている絵に置き換えたい。

23:00 結合テスト終わり。紙芝居のときの PRESS ANY KEY の描画位置がいつの間にかズレてしまっている。
X 座標を修正して終了。次は石碑だ。弱と強をまとめる。したがってメンバーは

* 5 連戦の最初の敵グループ ID
* 5 連戦制覇フラグ
* 強敵 3 連戦の最初の敵グループ ID

となる。意外に少なかった。

23:55 石碑（弱）の単体＆結合テストまで終わり。副作用によりオリジナル版と振る舞いに次の違いが生じた：

* 「初めた調べたフラグ」が石碑のすべてで共有されるようになった。
  例えば石碑 A を最初に調べてキャンセルして、石碑 B を次に調べるとすぐに「祈りますか？」が表示される。
  正直に言うとコモンイベントの `CSelf` 系変数の生存期間がわからない。
  `CSelf` 系変数はイベントをスコープとするのではなくて、静的変数なのかもしれない。
* 「ちょっと待って」のときに再生中の BGM が停止しなくなった。これはマップイベントのコードの末尾周辺を削除したことによる。
