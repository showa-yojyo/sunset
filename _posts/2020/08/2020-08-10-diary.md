---
title: 106 日目（晴れ）帰無仮説と対立仮説はセット
---

ナイトメアブレイド戦はよくわからないことが多いのでまだ続けたい。
ねこの足跡を観ながら眠る。テレビのタイマーがうまく使えた。

9:00 過ぎに起床。ああ疲れた。洗濯機を回しつつ朝飯（納豆とおにぎり）ときのうの数学ノートを着手。
洗濯物を干してしばらくすると暑くなる。

11:25 ノートが終わる。白ブリーフ一丁なのに上半身がもうジメジメしている。
昼前出発の都バスで八広方面に移動。もう歩いていくことはないかもしれない。

昼過ぎに八広図書館に到着。朝刊を読んでウンコをしようとしたら便器が汚れまくっている。
この図書館は誰か知らないがトイレを汚す輩が以前からいるようで、もう対応し切れない。
あきらめてキャレルに移動。持ち込み PC で遊ぶ。退館際に週刊文春をパラパラチェックする。

14:20 ビッグエー墨田八広店。138 円。

* コッペパンブルーベリー
* 元祖たこ焼き亭

隣の公園で食いながらバスを待つつもりだが、コッペパンを食い切るとバスが来る。
たこ焼きは横川で食おう。

横川バス停で降りて柳島児童遊園に徒歩移動。スナック菓子を食らう。
水浴びをしてから横川コミュニティー会館図書室に移動し、教科書を進める。

オリナスに移動。トイレをようやく済ませてタイトー F ステーションオリナス錦糸町店に潜る。
外が暑いので人がいっぱい遊んでいる。いきなり MJ をやる。
幻球バトル東風チップルール。これ、ひどいラスを引くとマイナ 100 とか平気で出る。怖い。
最終的に平均着順を 2.50 に戻したところで遊戯を終える。イヤなアガリ方をするヤツとよく同卓した。

19:40 カスミオリナス錦糸町店。486 円。

* 野菜ジュース 900ml
* 鶏カシューナッツ＆麻婆豆腐丼

20:05 ビッグエー墨田業平店。273 円。

* シュークリーム
* 絹豆腐 (3)
* 小粒納豆 (3)
* レーズンロール (4)

蒸し暑い向島を歩いて部屋に戻る。なぜか錦糸町付近よりも向島界隈のほうが暑い。
シャワーを浴びて晩飯。ローカルテレビ局の旅番組を観つつ。
PC で帳簿をつけて今晩はどうしようか。

22:45 数学ノート本日分の前半を終わる。SciPy の離散分布の `sf()` は
確率変数の付け方と 1 ズレる。

23:15 ナイトメアブレイド、シャドウレディ、ラスボスの三連戦を終わる。
ラスボスはうまくやると 40000 とかダメージを与えられるようだが、私の腕では 28000 くらいが限界らしい。

地獄の伯爵令嬢のほうもレベル上げを少し進める。弱い石碑の経験値リストも作成。

## Math Notes

薩摩順吉先生を続ける。

----

**検定**。**統計的仮説**：母集団の分布に関する何らかの仮定。
採択したり棄却したりするもの。この基準を**危険率** a.k.a. **有意水準**という。
値は $1\%$ か $5\%$ であることが多い。

----

例：大根。こういう事実があるとする：A 村で採れる大根はサイズが
$70$ 以上のものが $5\%$ であり、$80$ 以上のものは $1\%$ ある。

今、一本の大根があってサイズが $75$ である。これは A 村産であるかどうかを検定する。

仮説 $H_0$ を「この大根は A 村産である」とおく。

* 危険率 $5\%$ で検定するならば、大根のサイズが $70$ 以上であれば
  $H_0$ は棄却、$70$ 以下ならば採択する。この場合は $75 \gt 70$ より
  $H_0$ は棄却、すなわちこの大根は A 村産ではないとする。
* 危険率 $5\%$ というのは、誤りである確率が $5\%$ であるという意味だ。
* 危険率 $1\%$ で検定すると、この大根が A 村産であることを否定できない。

----

**帰無仮説**。棄却されなければ仮説は無に帰す。すなわち無意味である。

ここは要注意で「仮説が受け入れられる」implies「仮説が正しくないとは言えない」。
何も言っていないのと同じである。

----

**第一種の誤り**。$H_0$ が正しいのに棄却してしまうようなエラー。
この誤謬が起こる確率が危険率なのである。

**第二種の誤り**。$H_0$ とは別の仮説（対立仮説）が正しいのに
$H_0$ を採択する誤り。

----

帰無仮説を検定するときは、つねに対立の存在を仮定する。
例えば「母平均 $\mu$ が $2.0$ である」と $H_0$ とすると、$H_1$ としては次のようなものも考えられる：

* 「$\mu \gt 0$」や「$\mu \lt 0$」。これらは**片側検定**であるという。
* たんに「$\mu \ne 0$」。これは**両側検定**であるという。

----

例：サイコロを $400$ 回振って $224$ 回偶数が出た。
このサイコロはまともであるか。偶数の目が出やすいサイコロであるか。
危険率 $5\%$ および $1\%$ で検定しろ。

解：帰無仮説 $H_0$ を「サイコロはまともである」とおく。
言い換えると、偶数の出る確率を $p$ とおくと「$p = 1/2$」。

対立仮説 $H_1$ は「$p \ne 1/2$」。両側検定をすることになる。

仮説 $H_0$ の下で偶数目が出る回数を $X$ とおく。
これは二項分布 $\operatorname{Bin}(400, p)$ に従う。
平均と分散はそれぞれ

$$
\begin{aligned}
\mu &= np = 400 \cdot \frac{1}{2} = 200,\\
\sigma^2 &= np(1 - p) = 200 \cdot \frac{1}{2} = 100 = 10^2.
\end{aligned}
$$

である。試行回数が多いので正規分布で近似する。
$Z = (X - 200)/10$ は $N(0, 1)$ に従う。$X = 224$ のとき
$Z = 2.4.$

```python
>>> from scipy.stats import norm
>>> norm.interval(1 - 0.05)
(-1.959963984540054, 1.959963984540054)
>>> norm.interval(1 - 0.01)
(-2.5758293035489004, 2.5758293035489004)
```

$2.4 \gt 1.959...$ だから危険率を $5\%$ とすると棄却域にある。すなわち $H_0$ は棄却される：
サイコロはまともであるとは言えない。
一方、$2.4 \lt 2.575...$ だから危険率 $1\%$ で採択域にある：
サイコロはまともでないとは言えない（何も言えない）。
$\Box$

帰無仮説 $H_0$ をそのままに対立仮説 $H_1$ を「$p \gt 1/2$」とする。
つまり棄却域を山の右側にとる。片側検定。

```python
>>> norm.ppf(0.95)
1.6448536269514722
>>> norm.ppf(0.99)
2.3263478740408408
```

いずれの危険率に対しても $Z$ は棄却域内にある。したがって
$H_0$ は棄却され、サイコロは偶数目が出やすいと言える。
$\blacksquare$

----

問：コイントスを $4$ 回試行した。$4$ 回とも表が出た。このコインは表が出やすいと言えるか。
$5$ 回トスして $5$ 回とも表が出た場合はどうか。危険率 $5\%$ で考えろ。

解：$H_0$ を「コインはまともである」とする。この仮説の下で表が出る回数を $X$ とおく。

$4$ 回とも表が出る確率は $H_0$ の仮説の下で

$$
\begin{aligned}
P(X\!=\!4) = \left(\frac{1}{2}\right)^4 = 0.0625 \gt 0.05.
\end{aligned}
$$

確率が危険率より大きいので、$H_0$ は棄却できない。

$5$ 回トスのケースでは：

$$
\begin{aligned}
P(X\!=\!5) = \left(\frac{1}{2}\right)^5 = 0.03125 \lt 0.05.
\end{aligned}
$$

確率が危険率より小さいので、$H_0$ は棄却される。
$\blacksquare$

----

問：碁石がたくさん入っている箱が二つある。それぞれ A, B とする。

A には白石と黒石が $1 : 1$ の割合で入っており、
B には白石と黒石が $1 : 2$ の割合で入っている。

箱の一つから $6$ 個の碁石を復元抽出する。取れた白石の個数により帰無仮説
$H_0$「箱が A である」を検定する。

* 対立仮説 $H_1$ は何か。
* 危険率 $20\%$ とするとき棄却域はいくらか。第二種の誤りを犯す確率はいくらか。

解：$H_1$ は「箱が B である」しかない。

仮説 $H_0$ の下で取った白石の数を $X$ とする。
確率変数 $X$ は二項分布 $\operatorname{Bin}(6, 1/2)$ に従う。

```python
>>> from scipy.stats import binom
>>> for i in range(7):
...     print(f'P(X<={i}) = {binom(6, 0.5).cdf(i)}')
...
P(X<=0) = 0.015625
P(X<=1) = 0.10937500000000001
P(X<=2) = 0.3437500000000001
P(X<=3) = 0.6562499999999999
P(X<=4) = 0.890625
P(X<=5) = 0.984375
P(X<=6) = 1.0
```

SciPy の計算によると白石 $0, 1$ 個が棄却域である。

$H_1$ が正しいのに $H_0$ を採択してしまう確率とはすなわち
$H_1$ の下で白石を $2$ 個以上とる確率に等しい。
$H_1$ の下で $X$ は $\operatorname{Bin}(6, 1/3)$ に従う。

```python
>>> for i in range(-1, 7):
...     print(f'P(X>{i}) = {binom(6, 1/3).sf(i)}')
P(X>-1) = 1.0
P(X>0) = 0.9122085048010973
P(X>1) = 0.6488340192043893
P(X>2) = 0.319615912208505
P(X>3) = 0.10013717421124826
P(X>4) = 0.017832647462277088
P(X>5) = 0.0013717421124828527
P(X>6) = 0.0
```

`P(X>1)` の行が対応する。$64.9\%$ 程度の確率で第二種の誤りを犯す。
$\blacksquare$

----

以上
