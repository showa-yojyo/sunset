---
title: 104 日目（晴れ一時曇り）図書館ダブル巡回をしばらく定着化させたい
---

ボス戦については当時見落としいていた攻略法があって飽きない。寝る。
今晩はわりと涼しいほうだろう。

7:30 起床。朝方は明らかに涼しい。たまったペットボトルを処分。
朝飯は納豆とレーズンロール。足元の燃えるゴミ用袋に虫がたかりつつあるのでこれも処分。

9:00 PC 開始。10:35 宝箱リスト完成。これで次回は効率よくなる。

10:55 外出。曇っている。助かる。都バスに乗って四ツ木橋南詰へ。
それから歩いて八広図書館に移動。11:30 着。新聞を読んでキャレルに着席。
PC とにらめっこ。主にあやしいファイルをダウンロードすることに終止する。
YouTube で髭アーカイブの Burning Heat の回を視聴する。

13:15 過ぎ退館。13:40 ビッグエー墨田八広店。192 円。

* ポテチ塩
* 大きなおむすびツナマヨ

隣の公園で食う。バスを待って 14:00 過ぎに出発する。横川で降りる。
横川コミュニティー会館図書室に移動。教科書を進める。
月刊文藝春秋 2020.8 号も読める。石井妙子先生の寄稿によると、本来は『女帝』がまず世に出るはずだった。
しかし事実関係の裏付けや情報提供者の状況の深刻さが問題だった。
そこで単発の記事をいつぞやの同誌にまず発表した。
『女帝』は未読だが、その発表を読んでいるので内容の面白さは想像できる。

オリナスへ移動。トイレを済ませてタイトー F ステーションオリナス錦糸町店に入店。
結果的に 6 クレ使う。水を飲みすぎたらしく MJ プレイ中にトイレに二度行く羽目になる。

ビートマニア ARENA はマッチメイキング成立せず。レベル 11 の練習モードと化す。
MJ は幻球乱舞東風。憶えていないがちょい沈みくらい。段位を一つ上げてまた下げる。

19:05 カスミオリナス錦糸町店。507 円。

* 青椒肉絲丼
* 讃岐うどん

19:10 セリアオリナス錦糸町店。110 円。

* ごみ袋 45 リットル (16)

四ツ目通りを北上する経路で 19:45 向島の部屋に戻る。途中でバスに乗りたかったがタイミングが合わなすぎる。
テレビを観ながら晩飯なのだが、土曜のこの時間帯は地上波は悲惨なことになっているようだ。

風呂の時間までずっとファイル確認。異状なし。

21:40 シャワーを浴びる。しかし暑い。数学をやる。

23:05 ノート見直し終了。問題も解いていないことだし、区間推定は明日に回す。

寝るまである日の調査的プレイの続きをやろう。特殊ボスとラスボス以外のボスは全部倒した。
今回は守備用のアイテムがなかなか入手できない。

## Math Notes

薩摩本、まだまだ先がある。

----

**不偏推定量**。母平均や母分散が統計量の期待値として推定されるとき、それらの統計量を母数の不偏推定量という。

復習：母平均 $\mu$ の不偏推定量は標本平均 $\bar{X}$ であり、母分散
$\sigma^2$ の不偏推定量は $\dfrac{n}{n-1}S^2$ である。

例題：$10$ 個の卵の重さを調べたところ次のようになった。この標本値から不偏推定量を求める。

$$
65.1, 67.5, 71.5, 68.4, 70.1, 72.2, 68.7, 69.3, 70.6, 67.1.
$$

解：$\bar{x}, s^2$ を計算して母平均 $\mu = \bar x,\:\sigma^2 = \dfrac{10}{9}s^2$ とする。

```python
>>> data = (65.1, 67.5, 71.5, 68.4, 70.1, 72.2, 68.7, 69.3, 70.6, 67.1)
>>> n = len(data)
>>> xbar = sum(data) / n; xbar
69.05
>>> s2 = sum((xi - xbar)**2 for xi in data)/n; s2
4.184500000000004
>>> sigma2 = 10/9 * s2; sigma2
4.649444444444449
```

私はプログラマーなので出来合いのものを利用する：

```python
>>> import numpy as np
>>> data = np.array(data)
>>> xbar = data.mean(); xbar
69.05
>>> data.var() * (n := data.size) / (n - 1)
4.649444444444448
```

なお、`s2` の直接計算は関数 `statistics.pvariance()` を用いると得られる。
$\blacksquare$

----

**最尤推定量**。母集団分布の形は判明しているが、母数が未知のときにはこれから述べるような手法を採用する。

例：Poisson 母集団からサイズ $3$ の独立な標本を無作為抽出する。
このとき値が $x_1, x_2, x_3$ であるとする。このことから母平均 $\mu$ を決定する。

確率変数 $X_1, X_2, X_3$ それぞれが $x_1, x_2, x_3$ をとる確率を考える。
独立な標本であるという条件からこの確率は積で表される。

$$
\def\poisson#1{ \mathrm{e}^{-\mu}\frac{\mu^{-x_{#1}}}{x_{#1}!} }
\begin{aligned}
  &P(X_1\!=\!x_1, X_2\!=\!x_2, X_3\!=\!x_3)\\
= &P(X_1\!=\!x_1)P(X_2\!=\!x_2)P(X_3\!=\!x_3)\\
= &\poisson{1}\cdot\poisson{2}\cdot\poisson{3}\\
= &\mathrm{e}^{-3\mu}\frac{\mu^{x_1 + x_2 + x_3}}{x_1!x_2!x_3!}.
\end{aligned}
$$

これを $\mu$ の関数 $L(\mu)$ としてとらえる。**尤度関数**という。
この関数の値を最大とする $\mu$ が求める母平均である。

$$
\begin{aligned}
\frac{\mathrm{d}L(\mu)}{\mathrm{d}\mu}
&= -3L(\mu) + (x_1 + x_2 + x_3)L(\mu)\frac{1}{\mu}\\
&= \frac{L(\mu)}{\mu}(-3\mu + x_1 + x_2 + x_3).\\
\therefore \frac{\mathrm{d}L(\mu)}{\mathrm{d}\mu} &= 0 \iff \mu = \frac{x_1 + x_2 + x_3}{3} = \bar{x}.
\end{aligned}
$$

この結果は標本のサイズが $n$ のときに一般化できる。

----

例：$N(\mu, \sigma^2)$ に従う正規母集団からサイズ $n$ の互いに独立な標本を無作為抽出した。
標本値が $x_1, \dotsc, x_n$ であった。$\sigma^2$ が既知であるときの $\mu$ の最尤推定量を計算する。

この確率分布の PDF を $f(x)$ とおく。先ほどと同様に標本の独立性から

$$
\begin{aligned}
L(\mu) &= f_1(x)\dotsm f_n(x)\\
&= \left(\frac{1}{\sqrt{2\pi}\sigma}\right)^n\exp\left(-\frac{1}{2\sigma^2}\sum(x_i - \mu)^2\right).\\
\frac{\mathrm{d}L(\mu)}{\mathrm{d}\mu} &=-\frac{1}{2\sigma^2}\cdot 2\sum(\mu - x_i)L(\mu)\\
&= -\frac{1}{\sigma^2}(n\mu - \sum x_i)L(\mu).\\
\therefore \frac{\mathrm{d}L(\mu)}{\mathrm{d}\mu} &= 0 \iff
\mu = \frac{1}{n}\sum x_i = \bar{x}.
\end{aligned}
$$

したがって母分散が既知ならば母平均の最尤推定量は不偏推定量に等しい。

最尤推定量は不偏推定量とは一般には一致しない。

----

問：ある母集団からサイズが $7$ である標本を無作為抽出して標本平均と標本分散を計算した。
$\bar{X} = -2.0,\:S^2 = 0.72$ だった。これらから不偏推定量を決定しろ。

解：母平均 $\mu$ の不偏推定量は標本平均に等しいので

$$
\mu = \bar{X} = -2.0.
$$

母分散 $\sigma^2$ の不偏推定量は例の $n - 1$ ルールにより

$$
\sigma^2 = \frac{n}{n - 1}S^2 = \frac{7}{6}\cdot 0.72 = 0.84.
\;\blacksquare
$$

----

問：$N(\mu, \sigma^2)$ に従う正規母集団からサイズ $3$ の互いに独立な標本
$x_1, x_2, x_3$ を無作為抽出した。$\mu$ が既知のときの $\sigma^2$ の最尤推定量を決定しろ。

解：方針は上に述べたとおり。ただし尤度関数の変数を $\sigma$ とする。

$$
\def\f#1{ \frac{1}{\sqrt{2\pi}\sigma^2}\exp\!\left(-\frac{1}{2\sigma^2}({#1} - \mu)^2\right)\!}
\begin{aligned}
  L(\sigma) \coloneqq
  &P(X_1\!=\!x_1, X_2\!=\!x_2, X_3\!=\!x_3)\\
= &P(X_1\!=\!x_1)P(X_2\!=\!x_2)P(X_3\!=\!x_3)\\
= &f(x_1)f(x_2)f(x_3)\\
= &\f{x_1}\f{x_2}\f{x_3}\\
= &\left(\frac{1}{\sqrt{2\pi}\sigma}\right)^3\exp\!\left(-\frac{1}{2\sigma^2}\sum(x_i - \mu)^2\right).
\end{aligned}
$$

指数を書くのが面倒ゆえ $@$ で表すと：

$$
\begin{aligned}
\frac{\mathrm{d}L(\sigma)}{\mathrm{d\sigma}}
&= \left(\frac{1}{\sqrt{2\pi}}\right)^3(-3\sigma^{-4}\mathrm{e}^{@} + \sigma^{-3}\mathrm{e}^{@}(-\frac{1}{2})(-2\sigma^{-3}))\\
&= \left(\frac{1}{\sqrt{2\pi}\sigma}\right)^3(-3\sigma^{-1} + \sigma^{-3})\mathrm{e}^{@}\\
&= \frac{-3\sigma^2 + 1}{\sigma^3}L(\sigma).
\end{aligned}
$$

したがって $\sigma^2$ の最尤推定量は、この微分係数がゼロとなる $\dfrac{1}{3}$ である。
$\blacksquare$

----

以上
