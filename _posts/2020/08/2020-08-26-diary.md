---
title: 122 日目（晴れ）不動産屋・仲介業者を 4 軒まわる
---

まあまあ涼しいのでベッドで寝る。特に朝方は気分が優れない。これは参った。

9:00 過ぎに起きて朝飯。納豆とおにぎり。今日はさすがに部屋探しを進めないとまずい。
ウォーミングアップに区役所に移動してから物件探しスタート。

一軒目は向島某所の地域密着型不動産屋。こちらの条件を伝えたら風呂なしの部屋しかないという。
それはいいのだが、私のような若い人は借りないでしょという。若くないが。交渉決裂で終わり。

スカイツリータウンに立ち寄り休憩。二軒目は押上駅周辺の店で探すのが自然だ。
しかしいくつかの店が閉まっているので、後回しにする。徒歩で曳舟へ移動。

ひきふね図書館で新聞チェックでもするかと足を運ぶ。しかし出入口付近が面倒なことになっている。
それを見て萎えてしまい立ち去る。

二軒目は曳舟某所のやはり地域密着型不動産屋。厳しい条件を伝えたらいちおう一件あるという。
しかし住所が足立区であるためボツとなる。

歩いて八広図書館まで移動。今度こそ新聞＆雑誌休憩。増田こうすけ先生の挫折が気になる。

三軒目は八広某所の地域密着型不動産屋。ここでの聞き込みでようやく私の戦略が間違っていることに気づく。
この手の店で取り扱われている部屋は大家がいろいろとうるさいのだ。身元保証人が三親等内だとかわけのわからぬ条件を付けてくるという。
チェーン展開の業者で探すといいと助言をもらい、立ち去る。

バスに乗って押上方面に戻る。13:25 ビッグエー墨田業平店。170 円。

* ハムマヨパン
* パンケーキ

横川コミュニティー会館図書室の近所で食らい、そのまま図書室へ移動。
週刊新潮のバックナンバーと教科書をチェックする。

15:00 押上某所の仲介業者の店に入る。ここでようやくまともに部屋探しをしてもらえる。
福祉事務所の条件で厳しいのが家賃と床面積のバランスだ。風呂付きの物件など、この区内にはまずない。
とにかく見取図をいくつかもらって、またの来店を約束して去る。店員が熱心かつ親切で良い。

オリナス噴水前に移動して休憩。携帯電話チェック。異状なし。Twitter で暇つぶし。

タイトー F ステーションオリナス錦糸町店に潜入。6 クレ遊ぶ。
MJ プロ卓東風戦の最終ゲームは同卓者全員がガンガン行くタイプで疲れた。

19:35 カスミオリナス錦糸町店。436 円。

* 野菜ジュース 900
* 唐揚明太弁当

20:00 ビッグエー墨田業平店。149 円。

* シュークリーム
* レーズンロール (4)

さっきの物件リストのどこかに引っ越すとなると、この買物経路はお蔵入りだなと思いつつ部屋に戻る。
シャワーを浴びて上がって晩飯。

数学ノートを少し進めるか。

22:15 半分終了。残りは明日の夜にとっておく。
テザリングで PC でインターネットを見ようとしたが、今晩は半分くらいダメ。
結局携帯電話で Twitter のチェックをして終わる。あとは PC で遊ぶ。

23:15 地獄の各種ボス前データで遊ぶ。まさかラスボスで全滅するとは。
あとはダラダラして寝る。

## Math Notes

薩摩順吉著『確率・統計』第 6 章末問題を解く。

----

問：次の標本から母平均、母分散の不偏推定量を求めろ：

$$
2.8, 2.6, 3.2, 2.2, 2.5
$$

解：母平均 $\mu$ の不偏推定量は標本平均 $\bar X$ に等しい。
母分散 $\sigma^2$ の不偏推定量は標本分散に ${n/(n - 1)}$ を乗じて得られる。

```python
>>> import numpy as np
>>> x = np.array([2.8, 2.6, 3.2, 2.2, 2.5])
>>> xbar = x.mean(); xbar
2.66
>>> S2 = x.var(); S2
0.11040000000000001
>>> sigma2 = (n := x.size)/(n - 1) * S2; sigma2
0.138
>>> from statistics import variance
>>> variance(x)
0.13799999999999998
```

以上の計算により ${\mu = 2.66, \sigma^2 = 0.138.} \quad\blacksquare$

----

問：二項分布 $\operatorname{Bin}(n, p)$ に従う母集団から無作為に
$x_1, x_2$ を抽出する。母数 $p$ の最尤推定量はいくらか。

解：確率変数 $X_1, X_2$ それぞれが $x_1, x_2$ をとる確率を考える。
独立な標本であるという条件からこの確率は積で表される。

$$
\def\bin#1{ \binom{n}{x_{#1} }p^{x_{#1 } }(1 - p)^{1 - x_{#1} } }
\begin{aligned}
  &P(X_1\!=\!x_1, X_2\!=\!x_2)\\
= &P(X_1\!=\!x_1)P(X_2\!=\!x_2)\\
= &\bin{1}\bin{2}\cdot\\
= &\binom{n}{x_1}\binom{n}{x_2}p^{x_1 + x_2}(1 - p)^{2n - x_1 - x_2}.
\end{aligned}
$$

これを $p$ の関数と見て $L(p)$ とおく。この関数が極値をとる $p$ を調べる。

$$
\begin{aligned}
\frac{\mathrm{d}L}{\mathrm{d}p}
&= C(x_1 + x_2)p^{x_1 + x_2 - 1}(1 - p)^{2n - x_1 - x_2}\\
&\quad - Cp^{x_1 + x_2}(2n - x_1 - x_2)(1 - p)^{2n - x_1 - x_2 - 1}\\
&= L\left(\frac{x_1 + x_2}{p} - \frac{2n - x_1 - x_2}{1 - p}\right).\\
\therefore & \frac{\mathrm{d}L}{\mathrm{d}p} = 0\\
\iff & (1 - p)(x_1 + x_2) = p(2n - x_1 - x_2).\\
\iff & p = \frac{x_1 + x_2}{2n}.
\quad\blacksquare
\end{aligned}
$$

----

問：ハツカネズミ $8$ 頭の体重を測定したところ次のようになった。
経験上、母分散は $40^2$ であることが判明している。母平均値を信頼率
$80\%$ および $95\%$ で区間推定しろ。

$$
429, 498, 394, 426, 390, 459, 485, 374.
$$

解：母分散が known の場合の公式：

$$
\bar X - \frac{\sigma}{\sqrt{n} }z_1 \lt \mu \lt \bar X + \frac{\sigma}{\sqrt{n} }z_1.
$$

ここで ${(-z_1, z_1)}$ は正規分布 $N(0, 1)$ の中央区間である。

```python
>>> x = np.array([429, 498, 394, 426, 390, 459, 485, 374])
>>> xbar = x.mean(); xbar
431.875
>>> z1 = norm.interval(0.80)[1]; z1
1.2815515655446004
>>> sigma = 40
>>> from math import sqrt
>>> tmp = sigma / sqrt(x.size) * z1; tmp
18.123876048736463
>>> xbar - tmp, xbar + tmp
(413.75112395126354, 449.99887604873646)
>>> z1 = norm.interval(0.95)[1]; z1
1.959963984540054
>>> tmp = sigma / sqrt(x.size) * z1
>>> xbar - tmp, xbar + tmp
(404.15692351300646, 459.59307648699354)
```

したがって信頼率 $85\%$ では信頼区間 ${414 \lt \mu \lt 450,}$
$95\%$ では信頼区間 ${404 \lt \mu \lt 460.}\quad\blacksquare$

----

問：さっきの不偏推定量のデータに対して、信頼率 $95\%$ で母平均と母分散を区間推定しろ。

解：母平均については $F$ 分布または $t$ 分布により推定をする。後者を採用しよう。

$$
\bar X - \frac{S t_1}{\sqrt{n - 1} } \lt \mu \lt \bar X + \frac{S t_1}{\sqrt{n - 1} }.
$$

```python
>>> x = np.array([2.8, 2.6, 3.2, 2.2, 2.5])
>>> xbar = x.mean(); xbar
2.66
>>> S2 = x.var(); S2
0.11040000000000001
>>> S = sqrt(S2)
>>> n = len(x)
>>> from scipy.stats import t
>>> t(n - 1).interval(0.95)
(-2.7764451051977987, 2.7764451051977987)
>>> t1 = _[1]
>>> tmp = S * t1 / sqrt(n - 1); tmp
0.4612577032983623
>>> xbar - tmp, xbar + tmp
(2.1987422967016377, 3.1212577032983626)
```

したがって ${2.1987 \lt \mu \lt 3.1213.}$

母分散は自由度 $n - 1$ の $\chi^2$ 分布の公式を用いる。

```python
>>> from scipy.stats import chi2
>>> x1, x2 = chi2(n - 1).interval(0.95)
>>> x1, x2
(0.48441855708793014, 11.143286781877796)
>>> n * S2 / x2, n * S2 / x1
(0.049536551540404705, 1.1395104335356885)
```

したがって ${0.0495 \lt \sigma^2 \lt 1.1395.}\quad\blacksquare$

----

問：$000$ から $999$ をランダムに出力する装置がある。
これを $1000$ 回実行したところゾロ目が $15$ 回出た。
この装置はゾロ目が出やすいかどうかを危険率 $5\%$ で検定しろ。

解：帰無仮説 $H_0$ をゾロ目が出にくい、すなわち ${p = \dfrac{10}{1000} }$ とおく。
対立仮説 $H_1$ をゾロ目が出やすい、すなわち ${p \gt \dfrac{10}{1000} }$ とおく。
片側検定を行う。

ゾロ目の回数を $X$ とおくと、これは二項分布 $\operatorname{Bin}(1000, p)$ に従う。
$n \gg 1$ なので正規分布で近似する。

$$
\begin{aligned}
\mu &= np = 1000 \cdot p = 10,\\
\sigma^2 &= np(1 - p) = \frac{99}{10}.
\end{aligned}
$$

$Z = (X - \mu)/\sigma$ の変換をすると、$Z$ は $N(0, 1)$ に従う。

```python
>>> n = 1000
>>> X = 15
>>> p = 10 / n
>>> mu = n * p; mu
10.0
>>> sigma2 = n * p * (1 - p); sigma2
9.9
>>> Z = (X - mu) / sqrt(sigma2); Z
1.5891043154093203
>>> norm.isf(0.05)
1.6448536269514729
```

${Z \lt 1.6448...}$ より採択域にある。つまり $H_0$ は棄却されず、出やすいともそうでないとも言えない。
$\blacksquare$

----

以上
