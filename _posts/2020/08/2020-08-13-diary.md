---
title: 109 日目（晴れ一時雨）多項分布の極限の理屈がわからんでモヤモヤする
mathjax: true
---

暑いのでとっとと寝る。床、ベッド、床の順に移動しながら。深夜しかまともに眠れないのか。

9:05 起床。洗濯物がすぐにたまる。洗濯機にぶちこんでから朝食。納豆とレーズンロール。
テレビのワイドショーを視聴する。お盆でも平常営業で安心する。一拍置いてレギュラーは休みをとるはずだ。

洗濯機が止まるまで PC で今日の仕込み。きのうたわむれに作成した確率分布のプロットを見直したら出ていない色域があることに気づく。
そのバグを修正してキャプチャーし直す。日記に載せるのも何だからあとで Twitter に投稿しておこう。

10:10 洗濯物を干す。今着ているものを除いてすべて洗った感がある。服がまだ要るのか。
プロットの修正のついでに直近何日かぶんの日記の数学ノートも見直す。
最初から SciPy を使えばより早く慣れたのではないか。

11:25 バスに乗って八広方面に移動。更生橋での信号待ちが地味にきつい。
八広図書館ロビーで朝刊を読んで、館内キャレルで PC 作業。
今日も特に急ぎの用事ができていないようなので、のんびりファイルを集める。

14:00 ビッグエー墨田八広店。173 円。

* ハムマヨパン
* 大きなおむすび鮭

隣の公園で立ち食い。一本目のバスを食いながら見送って次の錦糸町駅行きに乗る。
横川三丁目停留所で降りて、横川コミュニティー会館図書室に移動。
教科書を少しだけ読む。多項分布の極限の推論が書かれていないで、少ししか進まなかった。

再びバス停に戻り、錦糸町行きに乗る。錦糸町駅バスターミナル付近で空模様が怪しくなる。

ハローワーク墨田。求人検索。特になし。外に出たら雨が降っている。急いでオリナスに移動。
雷が鳴っているが、ここにはスカイツリーがあるので何の心配もない。

タイトー F ステーションオリナス錦糸町店で 5 クレ遊ぶ。
ビートマニア ARENA を少しずつプレイしてきて、ついに TRANOID を解禁した。難しくて遊ばない可能性が高い曲だ。

MJ プロ卓東風戦。今月の着順分布がようやくちょい沈み程度まで戻せた。
一副露したトイトイ三暗刻単騎待ち（跳満）をアガったのが珍しい。

```text
【SCORE】
合計SCORE:+82.0

【最終段位】
四人打ち段位:鬼神 幻球:9

【8/13の最新8試合の履歴】
1st|**---*--
2nd|--*-*---
3rd|------**
4th|---*----
old         new

【順位】
1位回数:4(36.36%)
2位回数:2(18.18%)
3位回数:2(18.18%)
4位回数:3(27.27%)
平均順位:2.36

プレイ局数:51局

【打ち筋】
アガリ率:25.49%(13/51)
平均アガリ翻:3.38翻
平均アガリ巡目:11.38巡
振込み率:15.69%(8/51)

【8/13の最高役】
・跳満
・跳満
```

19:25 カスミオリナス錦糸町店。300 円。彩りチキン南蛮弁。

19:50 ビッグエー墨田業平店。343 円。

* シュークリーム
* 絹豆腐 (3)
* 小粒納豆 (3)
* ふっくらおむすび野沢菜
* 大きなおむすび鮭

スカイツリータウンのトイレを経由して向島の部屋に戻る。シャワーを浴びて晩飯にする。
白ブリーフ一丁で PC 作業。

22:05 きょうの数学ノートを終わる。この理解では多項分布の極限まで行けない。

地獄の伯爵令嬢の衝撃の事実。昨晩のレベル 80 のデータをセーブしていなかった。
経験値 36000 くらい無駄になった。とりあえずレベル 81 に上げる。次は 30 万。
得られる経験値が増えないので、最大レベルに近づくほど苦しくなる？

ラスボスを一周して終わる。前座がプリズミックミサイルで事故死したが、これでいいのか？

## Math Notes

薩摩順吉本を続ける。検定の問題と期待度数・観測度数の定義をやる。

----

問：公称排気量 $1800$ の自動車を $20$ 台抽出して実際に測定したところ、標本平均が
$1811$ で標本標準偏差が $19.7$ であった。母集団が正規分布に従うとして、次の場合に標本平均がズレているかどうか危険率
$5\%$ で検定しろ：

* 母分散が $15.0$ であると判明しているとき
* 母分散が不詳のとき

解：帰無仮説 $H_0$ を「$\mu = 1800$」とする。対立仮説 $H_1$ は単に
$H_0$ の否定「$\mu \ne 1800$」とおく。両側検定。

$$
Z \coloneqq \frac{\bar X - \mu}{\sigma/\sqrt{n} }
$$

の公式のパターンに当てはめて検定する。

```python
>>> from math import sqrt
>>> (1811 - 1800)/(15.0/sqrt(20))
3.279566366999692
>>> from scipy.stats import norm
>>> norm.interval(1 - 0.05)
(-1.959963984540054, 1.959963984540054)
```

$3.2795... \gt 1.9599...$ であるから $Z$ は棄却域にある。
したがって $H_0$ は棄却されてズレていると言える。
$\Box$

母分散が参照できない場合には次の値を $t$ 検定する：

$$
T \coloneqq \frac{\sqrt{n - 1} }{S}(\bar X - \mu).
$$

```python
>>> sqrt(20 - 1)*(1811 - 1800)/19.7
2.4339029633983458
>>> from scipy.stats import t
>>> t(19).interval(0.95)
(-2.093024054408263, 2.093024054408263)
```

$T = 2.4339... \gt 2.0930...$ であるから $T$ は棄却域にある。
したがって $H_0$ は棄却されてズレていると言える。
$\blacksquare$

----

問：[カセットテープ][20200809]の件で、規格では $\sigma \lt 10$ となっている。
この $10$ 巻は規格からズレているかどうか危険率 $5\%$ で検定しろ。

解：帰無仮説 $H_0$ を「$\sigma^2 = 10^2$」とおき、対立仮説 $H_1$ を「$\sigma^2 \lt 10^2$」と不等式の形で立てる。
分散は小さい方がうれしいからだ。

次の $Z$ が自由度 $n - 1$ の $\chi^2$ 分布に従うことを利用して片側検定をする：

$$
Z \coloneqq \frac{nS^2}{\sigma^2}.
$$

$S^2 = 158.49$ は計算済みである。

```python
>>> 10 * 158.49 / 100
15.849
>>> from scipy.stats import chi2
>>> chi2(9).isf(0.05)
16.91897760462045
```

$Z = 15.849 \lt 16.918...$ ゆえ $Z$ は採択域にある。
したがって、規格からズレているともいないとも言えない。
$\blacksquare$

----

問：ある工場である製品を製造している。午前中の製造品から $8$ 個とって強度を計測したら平均
$12.3$ の分散 $1.9$ であった。午後になって同様に $10$ 個とって調べると平均
$13.8$ の分散 $1.4$ であった。

* 午前と午後の分散は等しいか。危険率 $2\%$ で検定しろ。
* 午後のほうが午前のものよりも強度が大きいと言えるか。危険率 $5\%$ で検定しろ。

解：前半。帰無仮説 $H_0$ を「午前と午後で分散は等しい」とおき、対立仮説
$H_1$ をそのふつうの否定とする。

次の $X$ が自由度 $(m - 1, n - 1)$ の $F$ 分布に従うことに基づく両側検定を行う：

$$
X \coloneqq \frac{m(n - 1)S_x^2}{(m - 1)nS_y^2}.
$$

```python
>>> m, n, Sx2, Sy2 = 8, 10, 1.9, 1.4
>>> X = (m * (n - 1) * Sx2) / ((m - 1) * n * Sy2); X
1.3959183673469386
>>> from scipy.stats import f as F
>>> F(m - 1, n - 1).interval(1 - 0.02)
(0.14883715432369238, 5.612865477376243)
```

$0.1488... \lt X = 1.3959 \lt 5.6128...$ だから採択域にある。
したがって $H_0$ は棄却されない：午前と午後とで分散が等しいとも異なるとも言えない。
$\Box$

後半は午前と午後とで母分散が等しいと仮定する。$H_0$ を「～平均が等しい」とし、
$H_1$ は「午後のほうが強度が大きい」と仮定する（左側検定）。

次の $T$ が自由度 $m + n - 2 = 16$ の $t$ 分布に従う：

$$
T \coloneqq \frac{\sqrt{m + n - 2}(\mu_x - \mu_y)}{\sqrt{\left(\dfrac{1}{m} + \dfrac{1}{n}\right)}(mS_x^2 + nS_y^2)}.
$$

```python
>>> mu_x, mu_y = 12.3, 13.8
>>> T = sqrt(m + n - 2) * (mu_x - mu_y)/sqrt((1/m + 1/n)*(m*Sx2 + n*Sy2))
>>> T
-2.3408229439226114
>>> t(m + n - 2).ppf(0.05)
-1.7458836762762402
```

$T = -2.3408... \lt -1.7458...$ であるから棄却域にある。
したがって $H_0$ は棄却され、午後のほうが午前より強度があるとは言えない。
$\blacksquare

----

**期待度数**と**観測度数**。母集団が集合として互いに排他的な
$n$ 個のクラス $A_1, \dotsc, A_n$ に類別されているとし、
ある個体が各クラスに属する確率を $p_1, \dotsc, p_n$ であるとする。
$\sum p_i = 1.$

1. この母集団からサイズ $N$ の標本を抽出したときの値

   $$
   p_1N, \dotsc, p_nN
   $$

   を期待度数という。これは各クラスに属する標本内の個体数の期待値といえる。

2. それに対して各クラスの実際のサイズ

   $$
   x_1, \dotsc, x_n, \quad \sum_{i = 1}^n x_i = N
   $$

   を観測度数という。

観測度数を理論から決定される期待度数と比較しようというのが**適合度検定**である。

----

以上

[20200809]: {% post_url 2020/08/2020-08-09-diary %}
