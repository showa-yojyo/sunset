---
title: 107 日目（晴れ）井上陽水の歌のような暑さ
---

適当にテレビのチャンネルを変えていたらバキがアニメ化されている。何か無理しないと成り立たないと思う。
なんだか暑いが寝る。

7:25 に目が覚めるが、せっかく涼しくなっているので二度寝する。
何度かトイレに行くために起き上がるが 9:45 くらいまで横になる。
起床して朝飯。納豆とレーズンロール。

このあとハローワークで紹介状をもらうか。応募書類の仕込みをしたい。
ストックぶんの宛名書きは前回終わっている。履歴書と送付状（各社別になる）のタイムスタンプ更新、PDF 変換。

10:30 仕込み終わる。今日は暑くなるらしいから早めに行く。
まず隅田公園経由で区役所に入り、水分摂取およびトイレ。
都営浅草線本所吾妻橋駅から一駅だけ移動。

横川コミュニティー会館図書室に移動。朝刊と教科書の読み落とし部分のチェック。
読み落としはなかった……。ではなぜ理解したという自信がないのだ。

なんだかんだで徒歩でアルカキット錦糸町へ移動する。半蔵門線の地下道は助かる。

12:30 ダイソーアルカキット錦糸町店。110 円。角形二号封筒十枚。

くまざわ書店で雑誌チェック。盆なのでないのか。

ハローワーク墨田へ移動して、いきなり窓口を頼む。ストックから紹介状を三通もらう。
たんにとっておいた求人票の早い順に発注している。応募事業所の選定方法が不真面目だという謗りは免れない。

13:10 ファミリーマート江東橋一丁目店でいろいろプリントアウト。90 円。
ノート PC を持ち歩くという手段は暑いのでない。

ハローワークで封筒に宛名を書いて楽天地へ移動。
13:45 錦糸町パルコ内郵便局で応募書類を郵送。360 円。

13:55 西友錦糸町店。153 円。

* ボロニアンソーセージ
* バーガートマト

バスターミナルの木陰で立ち食い。都バスに乗って業平四丁目までワープ。
地下鉄の入口まで少し遠かった。素直に押上駅前で降りるのが正解？

とにかく都営浅草線に乗って本所吾妻橋駅に戻る。
14:40 向島の部屋に戻る。さっそくベッドのカバー、シーツを洗濯する。
水をコップ一杯飲んだら、その場で背中に汗が流れる。これは暑い。

PC 作業終わり。ミヤネ屋を観ながら洗濯機を待つ。この暑さだから今から干しても夜に間に合う。

16:00 直前のバスで八広へ移動する。都バスが自由に使えるのがほんとうにありがたい。
八広図書館（天国）に入っていきなり涼しいのがうれしい。朝刊はもう読んだからいきなりキャレルへ。
あいにく線路側は満席なので西日席だ。この分厚いカーテンにかけるしかない。
持ち込み PC で作業。

18:00 過ぎ退館。晩飯と明日の朝飯を買って帰ろう。

18:25 ビッグエー墨田八広店。537 円。

* 関西風＆広島風お好み焼き
* エクレア
* レーズンロール (4)
* ベビーチーズ明太子 (4)

どちらから帰ろうか迷うが、浅草寿町行のバスを、つまり四ツ木橋南詰バス停まで戻る。
さっきよりもバス停がより荒川寄りにあるのか。けっこう歩く。ここにも錦糸町行きのバスが停車することを忘れずにいよう。

なんだかんだで 19:00 前に向島に到着。部屋に戻ってシーツ類を取り込む。
ベッドメイクをしてから服を脱げる。いや暑い。シャワーを浴びて晩飯にする。
チーズがベトベトしているので、一個だけ食べて残りは冷蔵庫にしまう。冷蔵庫があるのがありがたい。

19:45 PC をミニ机に戻す。これを書いたり今日の求職情報を更新したりといろいろある。

21:20 数学ノートを終わる。もはや日記本体より長いのだが気にしない。
部分のデータから全体のことを一定の確率で把握する技法を学習している。
これを応用して麻雀の負けが混んだときに私が弱いのか不運なのかを（適当な危険率で）検定できるようになるはずだ。
その結果、残酷な真実が明らかになるかもしれないが、かまわない。

地獄の伯爵令嬢の逆襲。ボスラッシュ用データをプレイ。サンダーコールは装備しない。
そしてまだ理解が甘かった。二回やって二回失敗。

## Math Notes

薩摩順吉先生。母数の検定。

----

標本分布に基づいて母平均や母分散を検定する。以下、正規母集団に対して検定を行うものとする。

1. $\sigma^2$ が known のときの $\mu$ に関する検定
2. $\sigma^2$ が unknown のときの $\mu$ に関する検定（$t$ 検定）
3. $\sigma^2$ に関する検定
4. 二つの母集団の母分散の比に関する検定
5. 母分散が unknown のときの二つの母集団の母平均の差に関する検定
6. 同じ unknown の母分散をもつ二つの母集団の母平均の差に関する検定

----

### $\sigma^2$ が known のときの $\mu$ に関する検定

帰無仮説 $H_0$ 「母平均 $\mu = ...$」を検定する。
$Z \coloneqq \dfrac{\bar X - \mu}{\sigma/\sqrt{n} }$ が標準正規分布に従うことを利用する。

危険率 $\alpha$ に対して $Z$ の値が棄却域内にあれば $H_0$ を棄却する。

----

例題：男子バスケ部員 $25$ 名の身長を測定したところ、平均が $172.7$ であった。
全国の男子の身長が正規分布 $N(170.8, 5.7^2)$ に従うかを危険率 $5$ パーセントで検定しろ。

解：帰無仮説 $H_0$ を「$\mu = 170.8$」とし対立仮説 $H_1$ を「$\mu \ne 170.8$」とする。
両側検定をする。

```python
>>> from math import sqrt
>>> from scipy.stats import norm
>>> n, Xbar, mu, sigma2, alpha = 25, 172.7, 170.8, 5.7**2, 0.05
>>> Z = (Xbar - mu)/sqrt(sigma2/n); Z
1.6666666666666465
>>> norm.interval(1 - alpha)
(-1.959963984540054, 1.959963984540054)
```

これによると $Z$ は採択域内にあるので、$H_0$ を棄却できない。
$\blacksquare$

----

### $\sigma^2$ が unknown のときの $\mu$ に関する検定（$t$ 検定）

$H_0$ は先ほどと同じとする。
$T \coloneqq \dfrac{\sqrt{n - 1} }{S}(\bar X - \mu)$ が自由度 $n - 1$ の
$t$ 分布に従うことを利用する。

危険率 $\alpha$ に対して $T$ の値が棄却域内にあれば $H_0$ を棄却する。

----

例題：ラグビースパイクの工場ライン。規格ではスパイクは $17.00$ である。
今ラインから無作為に $15$ 品を抽出して標本平均と標本標準偏差をとったところそれぞれ $16.94, 0.10$ であった。
この標本平均は規格からずれていると言えるか。

解：$H_0$ を「$\mu = 17.00$」とする。両側検定とする：

```python
>>> from scipy.stats import t
>>> mu, n, Xbar, S = 17.00, 15, 16.94, 0.10
>>> T = sqrt(n - 1)*(Xbar - mu)/S; T
-2.244994432064317
>>> alpha = 0.05
>>> t(n - 1).interval(1 - alpha)
(-2.1447866879169273, 2.1447866879169273)
```

$T$ の値が棄却域にあるので $H_0$ が棄却される：この標本平均は規格に適合していない。
$\blacksquare$

----

### $\sigma^2$ に関する検定

$H_0$ を「母分散 $\sigma^2 = ...$」とおく。
$Z \coloneqq \dfrac{nS^2}{\sigma^2}$ が自由度 $n - 1$ の $\chi^2$ 分布に従うことを利用する。

危険率 $\alpha$ に対して $Z$ の値が棄却域内にあれば $H_0$ を棄却する。

----

例題：スパイク工場の続き。管理側は製品全体の $\sigma \lt 0.08$ であるとしている。
さきほどの標本の標本標準偏差はずれているか。危険率 $1$ パーセントで検定しろ。

解：こんどは対立仮説の置き方にコツが要る。

$H_0$ と $H_1$ をそれぞれ「$\sigma^2 = 0.08^2$」「$\sigma^2 \gt 0.08^2$」とする。
ばらつきがないのが望ましいので、このような対立仮説となる。つまり片側検定になる。

```python
>>> sigma = 0.08
>>> Z = (n * S**2) / sigma**2; Z
23.437500000000004
>>> from scipy.stats import chi2
>>> chi2(n - 1).isf(0.01)
29.141237740672796
```

$Z$ が採択域内にあるので何とも言えない。
$\blacksquare$

----

### 二つの母集団の母分散の比に関する検定

二つの正規母集団から無作為抽出した標本それぞれの標本分散を基にして
$H_0$「二つの正規母集団の母分散は等しい」を検定する。

標本の一方はサイズが $m$ で標本分散が $S_x^2$ とし、他方はサイズが $n$ で標本分散が $S_y^2$ であるとき、確率変数

$$
X \coloneqq \frac{m(n - 1)S_x^2}{n(m - 1)S_y^2}
$$

は自由度 $(m - 1, n - 1)$ の $F$ 分布に従うので、これを利用する。

危険率 $\alpha$ に対して $X$ の値が棄却域内にあれば $H_0$ を棄却する。

----

例題：バイク通学をしている学生がいる。彼の $31$ 日ぶんの通学時間の平均と標準偏差はそれぞれ
$263, 29$ であった。しかし警察にスピード違反を咎められてからの $11$ 日ぶんではそれらの値が
$286, 24$ になった。

どちらの場合も通学時間は正規分布に従うと仮定して、母分散が等しいかどうかを危険率 $2$ パーセントで検定しろ。

解：$H_0$ を「$\sigma_x^2 = \sigma_y^2$」とする。$H_1$ を「$\sigma_x^2 \ne \sigma_y^2$」とすることで両側検定を行う。

```python
>>> m, Xbar, Sx = 31, 263, 29
>>> n, Ybar, Sy = 11, 286, 24
>>> X = (m * (n - 1) * Sx**2) / (n * (m - 1) * Sy**2); X
1.371580387205387
>>> from scipy.stats import f
>>> f(m - 1, n - 1).interval(1 - 0.02)
(0.33567257242508525, 4.2469328174616185)
```

$X$ は採択域内にあるので、二つの母分散について何も言えない。
$\blacksquare$

----

### 母分散が unknown のときの二つの母集団の母平均の差に関する検定

二つの正規母集団から無作為抽出した標本それぞれの標本平均を基にして
$H_0$「二つの正規母集団の母分散は等しい」を検定する。

母集団をそれぞれ正規分布 $N(\mu_x, \sigma_x^2), N(\mu_y, \sigma_y^2)$ に従うものとし、
前者からサイズ $m$ の無作為抽出標本、後者からサイズ $n$ の無作為抽出標本をとるものとする。
それぞれの標本平均を $\bar X, \bar Y$ とする。

このとき $\bar X, \bar Y$ は $N(\mu_x, \sigma_x^2/m), N(\mu_y, \sigma_y^2/n)$ に従う。
正規分布の重ね合わせの原理により差 $\bar X - \bar Y$ は

$$
N\!\left(\mu_x - \mu_y, \frac{\sigma_x^2}{m} + \frac{\sigma_y^2}{n}\right)
$$

に従う（符号に注意しろ）。そして確率変数

$$
Z \coloneqq \frac{(\bar X - \bar Y) - (\mu_x - \mu_y)}{\sqrt{\dfrac{\sigma_x^2}{m} + \dfrac{\sigma_y^2}{n} } }
$$

は標準正規分布に従うことを利用する。

$H_0$ を「$\mu_x - \mu_y = 0$」とする。
危険率 $\alpha$ に対して $Z$ の値が棄却域内にあれば $H_0$ を棄却する。

----

例題：粉薬を $2000$ 入りの袋に詰める装置が二台ある。それぞれの装填量の標準偏差が
$20, 15$ であることが判明している。

今、それぞれの装置で $50$ 包ずつ粉薬を詰めたところ、一方の平均装填量が
$2001$ で他方が $1987$ であった。

両装置が装填する粉薬の量の平均は等しいかを危険率 $1$ パーセントで検定しろ。

解：$H_0$ を「$\mu_x - \mu_y = 0$」とおく。対立仮説を $H_0$ の単純な否定とする。

```python
>>> sigma_x, sigma_y = 20, 15
>>> m, n, Xbar, Ybar = 50, 50, 2001, 1987
>>> Z = ((Xbar - Ybar) - 0)/sqrt(sigma_x**2 / m + sigma_y**2 / n); Z
3.959797974644666
>>> norm.interval(1 - 0.01)
(-2.5758293035489004, 2.5758293035489004)
```

$Z$ は棄却域内にあるので $H_0$ は棄却され、二つの装置による粉薬の装填量の平均は等しくないと言える。
$\blacksquare$

----

### 同じ unknown の母分散をもつ二つの母集団の母平均の差に関する検定

二つの正規母集団から無作為抽出した標本それぞれの標本平均と標本分散を基にして
$H_0$「二つの正規母集団の母分散は等しい」を検定する。

条件はもうわかると思うので、いきなり式を書く：

$$
T \coloneqq \frac{\sqrt{m + n - 2}((\bar X - \bar Y) - (\mu_x - \mu_y))}{\sqrt{\left(\dfrac{1}{m} + \dfrac{1}{n}\right)(mS_x^2 + nS_y^2)} }
$$

は自由度 $m + n - 2$ の $t$ 分布に従うことを利用する。

$H_0$ を「$\mu_x - \mu_y = 0$」とする。
危険率 $\alpha$ に対して $T$ の値が棄却域内にあれば $H_0$ を棄却する。

----

例題：先ほどのバイク通学。スピード違反以後、通学時間は長くなったと言えるかを危険率
$5$ パーセントで検定しろ。

解：いちおう両者の母分散が等しいことを仮定して検定する。
違反前の平均 $\mu_x$ が違反後 $\mu_y$ になったとして
$H_0$ を「$\mu_x - \mu_y = 0$」とおく。

$H_1$ は題意から「$\mu_x - \mu_u \lt 0$」とするのが自然である。左側片側検定となる。

```python
>>> # m, Xbar, Sx = 31, 263, 29
>>> # n, Ybar, Sy = 11, 286, 24
>>> T = sqrt(m + n - 2)*((Xbar - Ybar) - 0)/sqrt((1/m + 1/n) * (m*Sx**2 + n*Sy**2))
>>> T
-2.3024539951855556
>>> t(m + n - 2).ppf(0.05)
-1.6838510113865808
```

$T$ が棄却域内にあるので $H_0$ を棄却する：通学時間は長くなってはいない。
$\blacksquare$

----

以上
