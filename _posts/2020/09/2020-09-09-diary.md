---
title: 136 日目（晴れ一時雨）よくわからない一日
---

0:00 過ぎに寝る。いったん 7:00 に起きるが精神を鎮めるため二度寝。
昨日の連絡ミスを今日取り返せないことがわかっているので諦めの二度寝。

10:00 起床。さすがに寝過ぎた。ワイドショーをチェックしつつ朝飯。
昨日の数学ノートの虫の問題で、図書館で紙に書いていなかった問題を思い出したのでそれを解く。

10:50 外出。隅田公園経由でバス停へ。実験的に東向島六丁目停留所で降りてみる。
八広公園前の横断歩道を通ることになる。ここでいいようだ。

11:20-12:45 八広図書館。朝刊と PC だけ。

水戸街道に戻ってバスに乗って向島に戻る。部屋に戻って PC カバンを置いてすぐに外出し直す。

14:20 ビッグエー墨田業平店。132 円。

* ハムマヨパン
* コッペパンホイップ＆チョコ

団地ベンチでおやつ休憩。14:30 横川コミュニティー会館図書室。教科書とねこ日和。
教科書の問題を解いていて、ボールペンのインクが切れかかっていることに気づく。
図書館を出てオリナス経由で楽天地へ。

16:05 錦糸町ロフト。よくわからない替芯を購入。88 円。

ちょっとブックオフロッテシティー錦糸町店に寄り道してマンガを探す。ラーメン発見伝の芹沢サンを発見。
「スープが冷めた日」がちゃんと収録されている。

タイトー F ステーションオリナス錦糸町店に移動。6 クレぶっこむ。
MJ プロ卓東風戦は勝ち切れない。

```text
【SCORE】
合計SCORE:-66.8

【最終段位】
四人打ち段位:神龍 幻球:12

【9/9の最新8試合の履歴】
1st|--------
2nd|-****---
3rd|-----***
4th|*-------
old         new

【順位】
1位回数:0(0.00%)
2位回数:5(55.56%)
3位回数:3(33.33%)
4位回数:1(11.11%)
平均順位:2.56

プレイ局数:52局

【打ち筋】
アガリ率:21.15%(11/52)
平均アガリ翻:3.09翻
平均アガリ巡目:10.91巡
振込み率:9.62%(5/52)

【9/9の最高役】
最高役のデータがありません。最高役は、跳満以上のアガリが対象となります。
```

19:40 カスミオリナス錦糸町店。210 円。八宝菜丼。

20:00 ビッグエー墨田業平店。284 円。

* シュークリーム
* 小粒納豆 (3)
* 絹豆腐 (3)
* 大きなおむすび鮭

向島の部屋に戻る。シャワーを浴びて晩飯。部屋の中が蒸し暑い。たまらない。

21:10 先に数学ノートをやるか。ランダムウォークの近似・正規化がよくわかっていないかもしれない。

23:10 テザリングでメールや Twitter をチェック。特になし。

残り時間である日～のレスセーブチャレンジ続きをやる。第二ダンジョン。
大事なところでクロエの音速剣が空振るのがほんとうに困る。どういう仕組みで攻撃ミスが生じるのかがわからない。

## Math Notes

薩摩順吉著『確率・統計』第 7 章演習問題前半。

----

問：等確率ランダムウォークにおいて、$t = 0$ で原点にいた人が $t = 1000$ で
区間 ${[-50, 50]}$ にいる確率はいくらか。

解：確率変数 $X$ を時刻 $t = 1000$ における位置とする。
このとき確率変数 ${k \coloneqq \dfrac{1000 - X}{2} }$ は二項分布 $\operatorname{Bin}(1000, 1/2)$ に従う。

二項分布 $\operatorname{Bin}(n, 1/2)$ において $n \to \infty$ のときの極限となる正規分布は、
平均、分散がそれぞれ ${\mu = n/2 = 500, \sigma^2 = n/4 = 250}$ である。
$t$ が十分大きいので $k$ は正規分布 $N(500, 250)$ に近似的に従うとする。

標準化して ${Z \coloneqq (k - 500)/\sqrt{250} }$ は $N(0, 1)$ に従う。

$$
\begin{aligned}
1000 - 2k = 50 \iff k = 475,\\
1000 - 2k = -50 \iff k = 525.\\
\end{aligned}
$$

```python
>>> norm.cdf((475 - 500)/sqrt(250))
0.056923149003329024
>>> norm.cdf((525 - 500)/sqrt(250))
0.9430768509966709
>>> _ - __
0.8861537019933419
```

もしくは[以前の議論][20200829]を用いて ${z = -\dfrac{1}{\sqrt{n} }(n - 2k) = -\dfrac{X}{\sqrt{n} } }$ が ${N(0, 1)}$ に従うとして

```python
>>> norm.cdf(-50/sqrt(1000))
0.056923149003329024
>>> norm.cdf(50/sqrt(1000))
0.9430768509966709
```

として求まる。
$\blacksquare$

----

問：$\text{(i)}$ [Poisson 過程の方程式][20200830]において極限 $\varDelta t \to 0$ をとると
$P(n, t)$ は次を満たす：

$$
\begin{cases}
\dfrac{\mathrm{d}P(n, t)}{\mathrm{d}t} &= -\lambda P(n, t) + \lambda P(n - 1, t), & n \ge 1,\\[2.0ex]
\dfrac{\mathrm{d}P(0, t)}{\mathrm{d}t} &= -\lambda P(0, t), & n = 0.\\
\end{cases}
$$

$\text{(ii)}$ この常微分方程式は次の一般解を持つ：

$$
P(n, t) = A \frac{(\lambda t)^n}{n!}\mathrm{e}^{-\lambda t}.
$$

$\text{(iii)}$ 時刻 $t$ に生物が $i$ 頭いる確率 $P(i, t)$ の $\sum_i P(i, t) = 1$
という条件から定数 $A$ を決定しろ。

$\text{(iv)}$ この過程で時刻 $t$ までに少なくとも生物が $1$ 頭生まれている確率はいくらか。

証明：$\text{(i)}$ $n \ge 1$ のときは

$$
\begin{aligned}
P(n, t + \varDelta t)
&= (1 - \lambda\varDelta t)P(n, t) + \lambda\varDelta tP(n - 1, t)\\
P(n, t + \varDelta t) - P(n, t) &= -\lambda\varDelta tP(n, t) + \lambda\varDelta tP(n - 1, t)\\
\frac{P(n, t + \varDelta t) - P(n, t)}{\varDelta t} &= -\lambda P(n, t) + \lambda P(n - 1, t).\\
\end{aligned}
$$

$\varDelta \to 0$ の極限をとると、左辺は $\dfrac{\mathrm{d}P(n, t)}{\mathrm{d}t}$ である。

$n = 0$ のときは

$$
\begin{aligned}
P(0, t + \varDelta t) &= (1 - \lambda\varDelta t)P(0, t)\\
P(0, t + \varDelta t) - P(0, t) &= - \lambda\varDelta tP(0, t)\\
\frac{P(0, t + \varDelta t) - P(0, t)}{\varDelta t} &= -\lambda P(0, t).
\end{aligned}
$$

$\varDelta \to 0$ の極限をとると、左辺は $\dfrac{\mathrm{d}P(0, t)}{\mathrm{d}t}$ である。
したがって与えられた常微分方程式が成り立つことが示された。
$\Box$

$\text{(ii)}$ $n \ge 1$ のときは

$$
\begin{aligned}
\frac{\mathrm{d}}{\mathrm{d}t}A \frac{(\lambda t)^n}{n!}\mathrm{e}^{-\lambda t}
&= A\frac{n\lambda(\lambda t)^{n - 1}}{n(n - 1)!}\mathrm{e}^{-\lambda t} + A\frac{(\lambda t)^n}{n!}(-\lambda\mathrm{e}^{-\lambda t})\\
&= \lambda P(n - 1, t) - \lambda P(n, t).
\end{aligned}
$$

$n = 0$ のときは

$$
\begin{aligned}
\frac{\mathrm{d}}{\mathrm{d}t}P(0, t)
&= \frac{\mathrm{d}}{\mathrm{d}t}A \mathrm{e}^{-\lambda t}\\
&= -\lambda A\mathrm{e}^{-\lambda t}\\
&= -\lambda P(0, t). \quad \Box
\end{aligned}
$$

$\text{(iii)}$ すべての時刻において確率の和が $1$ であるので次の等式が成り立つ：

$$
\begin{aligned}
\sum_{i = 0}^{\infty} A \frac{(\lambda t)^i}{i!}\mathrm{e}^{-\lambda t} &= 1\\
\sum_{i = 0}^{\infty} \frac{(\lambda t)^i}{i!} &= \frac{\mathrm{e}^{\lambda t} }{A}\\
\end{aligned}
$$

左辺の級数は $\mathrm{e}^{\lambda t}$ に等しいから $A = 1.\quad\Box$

$\text{(iv)}$ 時刻 $t$ までに一頭も生物が生まれていない確率が $P(0, t)$ であるので、
時刻 $t$ までに少なくとも一頭生物が生まれている確率は：

$$
1 - P(0, t) = 1 - \mathrm{e}^{-\lambda t}. \quad\blacksquare
$$

----

問：A と B の二人がゲームをする。ワンゲームごとに $1$ 円を賭ける。

* A の所持金を $x$ 円、
* B の所持金を $m - x$ 円

とするとき、$\text{(i)}$ A が破産する確率 $P(x)$ が次で表されることを示せ。ただし、ワンゲームにおいて
A が勝つ確率を $p$ とする。

$$
\begin{cases}
P(x) &= pP(x + 1) + (1 - p)P(x - 1), && 1 \le x \le m - 1,\\
P(0) &= 1, && x = 0,\\
P(m) &= 0, && x = m.\\
\end{cases}
$$

$\text{(ii)}$ 上の $1 \le x \le m - 1$ に対する式は次の形の解を持っている。

$$
P(x) = c_1 + c_2\left(\frac{1 - p}{p}\right)^x.
$$

このことと初期条件から定数 $c_1, c_2$ を決定しろ。

$\text{(iii)}$ 最初 A と B の所持金がそれぞれ $8$ 円と $2$ 円で、$p = 1/3$ のときの
A が破産する確率を求めろ。

解：$\text{(i)}$ A が破産する確率 $P(x)$ を初期の所持金が ${x - 1}$ のときと ${x + 1}$ のときの破産確率
${P(x - 1)}, {P(x + 1)}$で表すことを考える。初期所持金が ${0 \lt x \lt m}$ のときは、

* 最初のゲームに確率 $p$ で勝って、その結果所持金が $x + 1$ になって最終的に破産する確率 ${P(x + 1)}$ と、
* 最初のゲームに確率 $1 - p$ で負けて、その結果所持金が $x - 1$ になって最終的に破産する確率 ${P(x - 1)}$

との和として表せる。それゆえ第一式を得る。第二式、第三式は初期状態で破産していることを表している。
$\Box$

$\text{(ii)}$ $c_1, c_2$ は次の連立方程式を解くことで求まる：

$$
\begin{aligned}
1 &= P(0) = c_1 + c_2,\\
0 &= P(m) = c_1 + c_2\left(\frac{1 - p}{p}\right)^m.\\
\end{aligned}
$$

$$
\begin{aligned}
c_2 &= \cfrac{1}{1 - \left(\cfrac{1 - p}{p}\right)^m},\\
c_1 &= 1 - c_2 = \cfrac{-\left(\cfrac{1 - p}{p}\right)^m}{1 - \left(\cfrac{1 - p}{p}\right)^m}.
\end{aligned}
$$

$\text{(iii)}$ $x = 8, m = 10$ である。

$$
\begin{aligned}
c_2 &= \frac{1}{1 - 2^{10} },\\
c_1 &= \frac{-2^{10} }{1 - 2^{10}},\\
P(8) &= \frac{-2^{10} }{1 - 2^{10} } + \frac{1}{1 - 2^{10} }\cdot 2^8\\
&= \frac{-2^{10} + 2^8}{1 - 2^{10} }\\
&= \frac{1 -2^2}{1 - 2^{10} }\cdot 2^8\\
\end{aligned}
$$

電卓計算のほうが良さそうなのでそうする：

```python
>>> 2**8 * (1 - 2**2)/(1 - 2**10)
0.750733137829912
```

したがって A の破産確率は 約 $75.07\%$ である。
$\blacksquare$

----

以上

[20200829]: {% post_url 2020/08/2020-08-29-diary %}
[20200830]: {% post_url 2020/08/2020-08-30-diary %}
