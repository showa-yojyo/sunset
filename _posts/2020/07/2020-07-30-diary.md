---
title: 95 日目（曇り）書類審査が想定外に通り過ぎる
mathjax: true
---

0:00 レベル上げをやめて消灯準備。ブリキの博物館の映像を観ながら眠りにつく。
北原館長の登場まで保たずに眠る。

7:15 目が覚める。涼しいような気がする。しばらくして体が動くようになり起床。
朝飯はスパゲッティーミートソースと納豆。

8:25 外出。まず業平の銀行 ATM まで行って五十円玉を十円玉に両替する。
それから時間調整のためいつもの電話ボックスまで移動して、きのう書類審査を通してくれた会社に電話で連絡。
話が早いことに会社代表番号にかけたら採用担当者本人が出てくれる。面談の日程を合意。今日の午前とか言われなくてよかった。

9:25 向島の部屋に戻る。ワイドショーを観ながら PC 作業。
なんとなく Jekyll のビルド成果物、つまり当ブログをローカルで確認する。VS Code のプレビューだと問題なくても
HTML ファイルにすると数式がダメという事象が起こる。今回も発生している。
環境 `dcases` が無効らしい。手で修正する。
それにしてもインターネットに接続していないのに数式が表示されるのは不思議だ。
クラウドでレンダリングした結果をリダイレクトしてくれるという認識なのだが。

11:40 まで麻雀コードを書く。局回しの枠組み。デバッグライト：

```text
$ ./game.py
東風戦
東一局
東家 後堂  20,000 点 手牌 2m5m6m3s5s7s9s2p9p9p9p西白  3 シャンテン
南家 日蔭  20,000 点 手牌 2m3m5m8m3s7s3p5p6p北北発発  4 シャンテン
西家 山下  20,000 点 手牌 4m8m9m1s7s8s8s2p4p4p東東西  3 シャンテン
北家 橋場  20,000 点 手牌 1m2m3m3m8m3s6s8s6p8p東南中  4 シャンテン
東風戦
東二局
東家 日蔭  20,000 点 手牌 5m6m1s2s5s7s4p4p東東白白発  3 シャンテン
南家 山下  20,000 点 手牌 1m1m8m4s6s6s9s9s3p4p5p北中  3 シャンテン
西家 橋場  20,000 点 手牌 1s2s4s9s2p2p5p6p7p東北発中  4 シャンテン
北家 後堂  20,000 点 手牌 3m5m1s1s2s5s6s1p1p1p5p南発  3 シャンテン
東風戦
東三局
東家 山下  20,000 点 手牌 1m3m6m8m8m9m1s3s9s4p6p8p発  4 シャンテン
南家 橋場  20,000 点 手牌 2m2m5m9m3s4s8s3p4p7p9p白発  4 シャンテン
西家 後堂  20,000 点 手牌 1m3m4m9m6s3p4p4p南西西白白  3 シャンテン
北家 日蔭  20,000 点 手牌 1m2m3m7m8m7s8s9s6p南南北中  2 シャンテン
東風戦
東四局
東家 橋場  20,000 点 手牌 1m2m4m4m4m8m8m3p6p9p白発中  4 シャンテン
南家 後堂  20,000 点 手牌 1m2m3m9m1s2s3s7s7s東北白中  3 シャンテン
西家 日蔭  20,000 点 手牌 4m5m7m9m3s5s9s1p1p4p4p南西  4 シャンテン
北家 山下  20,000 点 手牌 2m2m3m8m9m1s7s8s9s2p7p東中  4 シャンテン
```

手牌が配牌のままなので説得力がないが各局終了直後の出力だ。ドラ表示が抜けている。
連荘していないので本場表示がここにはない。

麻雀の練習と地獄の八連荘をこなす。13:30 ごろ外出。
三省堂書店で雑誌チェック。週刊新潮の巻末のマンガの前担当編集者は曲者に違いないと前ブログで記した。
今回の内容を見てその直観は外れていないと再認識する。

14:30 ビッグエー墨田業平店。219 円。

* ふっくらおむすび梅
* すっぱムーチョ
* コッペパンホイップ＆チョコ

柳島児童遊園で食って横川コミュニティー会館図書室へ移動。朝刊と教科書を読む。
教科書を読み進めるペースがひじょうに遅いわけだが、滞在時間の上限撤廃はいつになるのか。

ハローワーク墨田に移動。求人を検索して知らない言葉も検索する。

タイトー F ステーションオリナス錦糸町店。5 クレ。
ビートマニアは ARENA 開催。私も 2 プレイやる。最初のゲームで対戦相手が全員人間で驚く。
二回目のゲームで 5.1.1. (Level 10) で AAA 獲れた。

MJ プロ卓東風戦。まあまあ。

```text
【SCORE】
合計SCORE:+33.2

【最終段位】
四人打ち段位:雷神 幻球:6

【7/30の最新8試合の履歴】
1st|-*--*-*-
2nd|--*-----
3rd|---*----
4th|-----*-E
old         new

【順位】
1位回数:3(42.86%)
2位回数:1(14.29%)
3位回数:1(14.29%)
4位回数:2(28.57%)
平均順位:2.29

プレイ局数:37局

【打ち筋】
アガリ率:18.92%(7/37)
平均アガリ翻:3.14翻
平均アガリ巡目:11.86巡
振込み率:8.11%(3/37)

【7/30の最高役】
最高役のデータがありません。最高役は、跳満以上のアガリが対象となります。
```

19:05 カスミオリナス錦糸町店。336 円。八宝菜丼。

19:30 ビッグエー墨田業平店。327 円。明日の朝飯になりそうなものが売り切れ。

* 絹豆腐 (3)
* 野菜ジュース 200ml
* シュークリーム
* クロコッペ

19:45 向島の部屋に戻る。テレビを見ながら晩飯。帳簿。

20:25 電話ボックスへ移動。メールを確認したらまた応募が受かっている連絡がある。
こんなに受かるとは正直思っていなかったので、面接が立て込んでしまい困ったことになった。
とりあえずメールの返事は明日電話でするしかない。今朝のように。

適当にウェブを見て向島の部屋に戻る。風呂に入って口の下をなぜか切って出血。

21:20 風呂から上がって今の状況を整理。それから図書館で読んだ教科書の復習。

22:45 復習終わり。SciPy を利用するときには確率分布の `isf()` をよく使うことが体でわかる。
さあ経験値稼ぎの追い込みだ。

24:00 あと経験値 12000 ポイントくらいで最終レベルというところまで来た。
しかし火のオーブが付きて持ち金もないので今日はこれで終わる。

## Math Notes

$F$ 分布。互いに独立な確率変数 $X_1, X_2$ がそれぞれ自由度 $m, n$ の $\chi^2$ 分布に従うとする。
このとき $X_1/m$ と $X_2/m$ の比の従う分布を考える。

まず $X \coloneqq \dfrac{X_1/m}{X_2/n},\:Y:= mX_2$ を導入する。
$X, Y$ の同時確率分布を $f(x, y)$ とおく。すると $X$ の従う確率分布
$f_{m, n}(x)$ は次の周辺分布である：

$$
\begin{aligned}
f_{m, n}(x) = \int_{-\infty}^\infty\!f(x, y)\,\mathrm dy.
\end{aligned}
$$

$X_1, X_2$ の独立性から次のように分離できる：

$$
f(x, y)\,\mathrm dx\mathrm dy = T_m(x_1)T_n(x_2)\,\mathrm dx_1\mathrm dx_2.
$$

一方、変数変換の Jacobian から次が成り立つ：

$$
\begin{aligned}
\mathrm dx_1\mathrm dx_2 &=
\begin{vmatrix}
\dfrac{\partial x_1}{\partial x} & \dfrac{\partial x_1}{\partial y}\\
\dfrac{\partial x_2}{\partial x} & \dfrac{\partial x_2}{\partial y}
\end{vmatrix}\mathrm dx\mathrm dy\\
&=
\begin{vmatrix}
y/n & x/n\\
0 & 1/n
\end{vmatrix}\mathrm dx\mathrm dy & \because X_1 = \frac{XY}{n},\;X_2 = \frac{Y}{m}.\\
&= \frac{y}{mn}\,\mathrm dx\mathrm dy.\\
\therefore f(x, y) &= \frac{y}{mn}T_m\!\left(\frac{xy}{n}\right)\!T_n\!\left(\frac{y}{m}\right).
\end{aligned}
$$

これを基に周辺分布を計算すると次が得られる：

$$
\begin{aligned}
f_{m, n}(x) = \begin{cases}
\dfrac{m^{m/2}n^{n/2}x^{(m - 2)/2}}{B(m/2, n/2)(mx + n)^{(m + n)/2}}, & x \gt 0,\\
0, & x \le 0.
\end{cases}
\end{aligned}
$$

この分布を自由度 $(m, n)$ の $F$ 分布という。

----

統計処理では $\displaystyle \int_t^\infty\!f_{m, n}(x)\,\mathrm dx = \alpha$
となる $\alpha$ と $t$ を知る必要がある。これは教科書の巻末に表になっている。

----

$F$ 分布の適用。$F$ 分布は標本分散の比に関する情報を与える。

今、平均が未知で分散が $\sigma^2$ である正規分布に従う正規母集団から
$m$ 個の標本を無作為抽出して標本分散 $S_x^2$ を計算する。これは確率変数
$X_1 \coloneqq \dfrac{mS_x^2}{\sigma^2}$ が自由度 $m - 1$ の $\chi^2$ 分布に従う。

さらにやはり平均が未知で分散が同じ $\sigma^2$ である正規分布に従う**別の**正規母集団から
$n$ 個の標本を無作為抽出して標本分散 $S_y^2$ を計算する。同様にして
$X_2 \coloneqq \dfrac{nS_y^2}{\sigma^2}$ が自由度 $n - 1$ の $\chi^2$ 分布に従う。

上の結果から、次の確率変数 $X$ は $f_{m-1, n-1}(x)$ に従うのである：

$$
\begin{aligned}
X \coloneqq \frac{mS_x^2/\sigma^2}{m - 1}/\frac{nS_y^2\sigma^2}{n - 1}
= \frac{m(n - 1)S_x^2}{n(m - 1)S_y^2}.
\end{aligned}
$$

----

例：母分散の等しい別々の正規母集団がある。一方から無作為に $6$ 個をとって標本分散を計算すると
$15.2$ であった。他方からやはり無作為に $9$ 個とって標本分散を計算すると $2.57$ であった。

このような結果が生じる確率は $5$ パーセントより低いか高いか。

解：自由度 $(5, 8)$ の $F$ 分布に従う。

$$
\begin{aligned}
X = \frac{6\cdot(9 - 1)\cdot15.2}{9\cdot(6 - 1)\cdot 2.57}
\end{aligned}
$$

Python の SciPy では `scipy.stats.f` を利用して数値計算を行う。

```python
>>> from scipy.stats import f
>>> X = 6 * (9 - 1) * 15.2 / (9 * (6 - 1) * 2.57); X
6.308690012970168
>>> f.isf(0.05, 6 - 1, 9 - 1)
3.6874986663400273
>>> # 1 から引いて ppf() も同じ：
>>> f.ppf(0.95, 5, 8)
3.6874986663400273
```

昨日も言ったがメソッド `isf()` は右側面積を与えて対応する座標成分を返すものだ。
$100 - 5$ パーセントに対応する確率変数は $3.68...$ という値だとわかる。


$3.68... \lt 6.30...$ だから $5$ パーセントより低いと言える。
$\blacksquare$

----

$N(\mu, \sigma^2)$ に従う母集団から無作為抽出した大きさ $n$ の標本について
$\dfrac{n(\bar{X} - \mu)^2}{\sigma^2}$ が自由度 $1$ の $\chi^2$ 分布に従うことを前回習った。
そして $\dfrac{nS^2}{\sigma^2}$ は自由度 $n - 1$ の $\chi^2$ 分布に従うのだった。
これらの確率変数の比は $F$ 分布 $f_{1, n-1}(x)$に従う：

$$
\begin{aligned}
X \coloneqq \frac{n(\bar{X} - \mu)^2/\sigma^2}{1}/\frac{nS^2/\sigma^2}{n - 1}
= \frac{(n - 1)(\bar{X} - \mu)^2}{S^2}
\end{aligned}
$$

----

例：母平均 $\mu = 6.3$ の正規母集団から $20$ 個を無作為抽出して標本を作る。
標本平均、標本分散をそれぞれ計算すると $\bar{X} = 8.2,\;S^2 = 12.6$ であった。
このような結果が生じる確率は $1$ パーセントより小さいか大きいか。

解：

$$
X = \frac{(20 - 1)(8.2 - 6.3)^2}{12.6} = 5.4436...
$$

```python
>>> X = (20 - 1)*(8.2 - 6.3)**2/12.6; X
5.44365079365079
>>> f.isf(0.01, 1, 20 - 1)
8.184946822468913
```

$8.18... \gt 5.44...$ だから $1$ パーセントより大きいと言える。
$\blacksquare$

----

命題：母集団 1 と 2 が $N(\mu_x, \sigma^2)$ と $N(\mu_y, \sigma^2)$ に従っている。
それぞれから大きさ $m$ の標本と大きさ $n$ の標本をとって、標本平均と標本分散をそれぞれ計算する。
このとき次の確率変数 $X$ は自由度 $(1, m + n - 2)$ の $F$ 分布に従う：

$$
\begin{aligned}
X \coloneqq \frac{(m + n - 2)((\bar{X} - \bar{Y}) - (\mu_x - \mu_y))^2}{(1/m + 1/n)(mS_x^2 + nS_y^2)}.
\end{aligned}
$$

証明：標本平均 $\bar{X}, \bar{Y}$ はそれぞれ
$N(\mu_x, \sigma^2/m),\;N(\mu_y, \sigma^2/n)$ に従う。
正規分布の重ね合わせの原理により

$$
Z \coloneqq (\bar{X} - \mu_x) - (\bar{Y} - \mu_y)
$$

は $N(0, (1/m + 1/n)\sigma^2)$ に従う。したがって
$Z^2/((1/m + 1/n)\sigma^2)$ は自由度 $1$ の $\chi^2$ 分布に従う。

さらに $\dfrac{mS_x^2}{\sigma^2},\;\dfrac{nS_y^2}{\sigma^2}$ はそれぞれ自由度
$m - 1,\;n - 1$ の $\chi^2$ 分布に従う。$\chi^2$ 分布の重ね合わせの原理により

$$
\frac{mS_x^2 + nS_y^2}{\sigma^2}
$$

は自由度 $m + n - 2$ の $\chi^2$ 分布に従う。したがって

$$
\begin{aligned}
X &\coloneqq \frac{Z^2/(1/m + 1/n)\sigma^2}{1}/\frac{(mS_x^2 + nS_y^2)/\sigma^2}{m + n - 2}\\
&= \frac{(m + n - 2)Z^2}{(1/m + 1/n)(mS_x^2 + nS_y^2)}
\end{aligned}
$$

は $f_{1, m + n - 2}(x)$ に従うことが示された。
$\blacksquare$

----

例：$N(2.0, 8)$ に従う母集団から $5$ 個無作為抽出すると
$\bar{X} = 5.3,\;S_x^2 = 12$ であった。また
$N(3.5, 8)$ に従う母集団から $6$ 個無作為抽出すると
$\bar{Y} = 2.1,\;S_y^2 = 10$ であった。

このようなことが起こる確率は $5$ パーセントより小さいか大きいか。

解：いきなり Python でやる。

```python
>>> X = (5 + 6 - 2)*((5.3 - 2.1) - (2.0 - 3.5))**2 / ((1/5 + 1/6)*(5*12 + 6*10))
; X
4.518409090909089
>>> f.isf(0.05, 1, 5 + 6 - 2)
5.117355029199227
```

$5.117... \gt 4.518...$ であるから $5$ パーセントより大きいと言える。
$\blacksquare$

----

以上
