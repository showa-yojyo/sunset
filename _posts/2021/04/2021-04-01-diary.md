---
title: 340 日目（曇り）メール来ない
---

月始めなのでそれ用のファイル整理をしたり竹書房の新所在地をチェックしたりする。このあとゲームをやって寝る。

[ウルファールのサンプルゲーム with DTC][bshf21b] 例のセーブでバッドレディーズ～ファルコ～ラスボス。
ファルコ戦でエディに攻撃が集中するようにして、守備力を上げまくりの攻撃力を下げまくりで自然に勝つことができる。
風神の盾、竜鱗の髪飾り、ウィングブーツを標準装備にすればこちらの守りは問題ない。

7:05 起床。また眠い。納豆と白飯を食って出勤。いったんコンビニに寄ってキンマの裏表紙をチェック。
竹書房の新所在地が三番町に変わっていることを確認。

7:45 現場管理人室到着。書類の準備をしてから出動。最近猫糞が連荘で裏庭にあるのが気に入らない。
ゴミ部屋で作業をしているとたまに入居者がゴミを置きに来る。あいさつしない人のゴミが分別されていない傾向が明らかにある。これは意外な発見だ。

10:00 作業終了。撤収。イトーヨーカドー曳舟店に寄って体温チェック。
コンビニに道草して雑誌チェック。イチジョウにおける大山の描写が細かくて感心。
ついでにハンチョウもチェックしたら、大槻が宮本宅の留守番中にやりたい放題やっていて笑える。

10:45 曳舟の部屋に戻る。洗濯機を回し始める。待ち時間に PC を起動して XPath の練習か。
ブラウザーの開発ツールコンソールで `$x()` に XPath 式を与えて評価させとるノードが得られる。
[Scrapy] のシェルを起動するより早い。きのう見た入門編をすべてチェック。
これで気づいたが、XPath はノードを表現するものなのだ。要素の属性の値を得ることを期待するのは筋が違う。
例えば `a` や `img` から `href` や `src` の値が欲しくても XPath の評価一発では出ないということだ。

12:00 おやつ休憩、麻雀の練習。

12:30 コンソールに戻る。

* 属性の値はいちおうノードに対して `.value` とすれば得られる。
* 関数 `string()` が HTML タグの入り交じるテキストを抽出するのに使える。

眠い。かなり寝る。

16:10 起床。外出。スカイツリータウンに移動。トイレ。バス停に移動。乗車。錦糸公園前まで移動。

17:15 タイトー F ステーションオリナス錦糸町店。MJ プロ卓東風戦 5 クレ。なかなかいい成績だ。

今日は全体的にドラを切って勝負に行く場面が多く、そのほとんどがドラ切りで正解だった。
唯一失敗だったのは、下家が自風を暗槓、カンドラが東になり、私の手牌に暗刻である。いきなりのチャンス。
もう浮いているドラ五索が要らないので、次巡に切ったら下家からロン。まさかと思っていたドラ五索単騎待ち。
下家は先々月二位の超上級者なので文句を言うつもりはないが、なぜわざわざ警戒されるような槓を敢えてしたのか……。
単に私がナメられていた？

```text
【SCORE】
合計SCORE:+92.2

【最終段位】
四人打ち段位:神龍 幻球:11

【4/1の最新8試合の履歴】
1st|-*--*-*-
2nd|---*----
3rd|*------*
4th|--*--*--
old         new

【順位】
1位回数:4(40.00%)
2位回数:1(10.00%)
3位回数:3(30.00%)
4位回数:2(20.00%)
平均順位:2.30

プレイ局数:50局

【打ち筋】
アガリ率:24.00%(12/50)
平均アガリ翻:4.08翻
平均アガリ巡目:13.58巡
振込み率:16.00%(8/50)

【4/1の最高役】
・倍満
```

配牌で暗刻が二面子あったがドラの一筒が浮いていてどう進めるか思案していたら重なった。
では鳴いてトイトイへ移行するかと思ったら、門前で仕上がった。
手が手なので、いきなり 24000 点を振り込ませて東パツでゲームセットは勿体ない。リーチして危険信号を他家全員に送信。
しかし、やはりトイトイ狙いの上家の索子下辺張搭子が対子に変換する前に放銃。

![御無礼。一発です。24000 でトビですね。]({{ "/assets/images/20210401-mj.png" | relative_url }})

19:45 カスミオリナス錦糸町店。363 円。木曜恒例クーポンゲット。

* 生姜焼き丼
* ブラックチョコ
* ライス

20:15 ビッグエー墨田業平店。396 円。

* 絹豆腐
* スライスチーズ (5)
* 小粒納豆 (3)
* ハムマヨパン
* クリームパン
* ドデカイラーメンチキン (+20%)

20:25 曳舟の部屋に戻る。入浴。

20:50 風呂から出て PC に戻る。豆腐がうまい。家計簿と日記を進める。
LibreOffice Calc のシート追加にはテンプレートの考え方があるのかないのか。

麻雀の練習をしてから 21:40 テザリング開始。調べ物のついでに XPath 関数の早見表を作成。
ブラウザーのコンソールで XPath を指定して処理できることを利用する。
ただ、私は JavaScript をよく知らないのでコレクションのループを書くのもままならない。
`for ... in ...` と `for ... of ...` の二種類あるのは勘弁して欲しい。
ろくに調べずに後者のつもりで前者を書いて実行して連番が得られて怒る多言語ユーザーがたくさんいると思う。

23:50 ノート作業終わり。XPath は入門レベルの知識で十分使えるという腰の軽い仕様のようだ。

## XPath Note

### Functions

MDN の [The Netscape XSLT/XPath Reference - XSLT: Extensible Stylesheet Language Transformations](https://developer.mozilla.org/en-US/docs/Web/XSLT/Transforming_XML_with_XSLT/The_Netscape_XSLT_XPath_Reference) より。

| name | description | comment |
|------|-------------|---------|
| `boolean()` | XPath 式を true または false に評価する | 明示的に真偽値に変換する必要があるときに使う |
| `ceiling()` | C/C++ の `ceil()` と同様 | 使いそうにない |
| `concat()` | 複数の文字列を `cat` する | 任意の個数の文字列を与えて構わない |
| `contains()` | 第一引数の文字列が第二引数の文字列を部分として含むか | 頻出 |
| `count()` | ノード集合の個数を返す | 頻出 |
| `current()` | カレントノードを返す | 詳細不明 |
| `document()` | 略 | 略 |
| `element-available()` | 略 | 略 |
| `false()` | UNIX の `false` と同様 | 明示的にこれを使う場面があるか |
| `floor()` | C/C++ のそれと同様 | 使いそうにない |
| `format-number()` | 数値を書式に基づいて文字列として返す | 詳細不明 |
| `function-available()` | 略 | 略 |
| `generate-id()` | 略 | 略 |
| `id()` | 与えられた何かにマッチするノードを検索して、それを含むノードを返す | 微妙にわかりにくい |
| `key()` | 略 | 略 |
| `lang()` | 略 | 略 |
| `last()` | 式評価コンテキストから決まるサイズの値を返す | 頻出 |
| `local-name()` | ノードセットの最初のノードのローカル名を返す | ローカル名とは何か |
| `name()` | ノードセットの最初のノードの完全修飾名を返す | 頻出 |
| `namespace-uri()` | ノードセットの最初のノードの名前空間 URI を返す | `http://www.w3.org/1999/xhtml` のような文字列 |
| `normalize-space()` | 空白文字を適宜トリムする | 前回のノート参照 |
| `not()` | 与えられた真偽値の否定値を返す | 頻出 |
| `number()` | 引数を数値に変換して返す | ここで言う変換とは？ |
| `position()` | 式評価コンテキストから決まる位置を返す | 配列の添字であると考える |
| `round()` | C/C++ のそれと同様 | |
| `starts-with()` | 第一引数の文字列が第二引数の文字列から始まるか | 頻出 |
| `string()` | 文字列に変換する | 頻出 |
| `string-length()` | 文字列を構成する文字の個数を返す | 引数なしのときは文書全体の文字数を返すようだ |
| `substring()` | 部分文字列を返す | start/length 方式 |
| `substring-after()` | 第一引数文字列のうち、第二引数文字列以降の部分文字列を返す | 返り値は第二引数文字列を含まない |
| `substring-before()` | 第一引数文字列のうち、第二引数文字列以前の部分文字列を返す | 返り値は第二引数文字列を含まない |
| `sum()` | 各ノードの数値の和を返す | 詳細不明 |
| `system-property()` | 略 | 略 |
| `translate()` | Python の `str.translate()` と同様 | |
| `true()` | UNIX の `true` と同様 | 明示的にこれを使う場面があるか |
| `unparsed-entity-url()` | 略 | 略 |

ちなみにこの図表のインデックス列はブラウザーのデバッグツールで XPath から生成した。

```javascript
for(let i of $x('//h3[@id="functions"]/following::h4/a/text()')){
    console.log(i)
}
```

[bshf21b]: https://wodifes.net/game/show/446
[scrapy]: https://scrapy.org/

